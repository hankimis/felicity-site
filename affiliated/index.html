<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>온비트 - 제휴 거래소</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/base/_variables.css"/> 
    <link rel="stylesheet" href="../css/style.css"/>
    <link rel="stylesheet" href="../auth.css"/>
    <link rel="stylesheet" href="../css/pages/partnerslide.css"/>
    <link rel="stylesheet" href="affiliated.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" />
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <link rel="icon" type="image/png" href="/onbit/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/onbit/favicon.svg" />
    <link rel="shortcut icon" href="/onbit/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/onbit/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Onbit" />
    <link rel="manifest" href="/onbit/site.webmanifest" />
    
    <!-- Common Scripts -->
    <script src="../js/auth.js"></script>
    <!-- Unified Header Loader -->
    <script src="../components/header/header-loader.js" defer></script>
    <!-- Cloudflare Turnstile -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</head>
<body>
    <!-- 헤더 플레이스홀더 -->
    <div id="header-placeholder"></div>
    
    <main class="main-container affiliated-page">
        <!-- 온비트 페이백 메인 배너 -->
        <section class="onbit-payback-banner">
          <div class="banner-image-container">
            <img src="../assets/affiliated-banner/bannerpics.png" alt="온비트 페이백 배너" class="banner-image">
          </div>
          <div class="banner-content">
            <h1 class="onbit-payback-title">수수료, 제휴 거래소에서 바로 페이백</h1>
            <div class="payback-stats-row">
              <div class="payback-stat">
                <div id="payback-users" class="payback-stat-value">0</div>
                <div class="payback-stat-label">온비트 페이백 가입자 수</div>
              </div>
              <div class="payback-stat">
                <div id="payback-volume" class="payback-stat-value">0</div>
                <div class="payback-stat-label">하루 평균 페이백 거래량 (USD)</div>
              </div>
              <div class="payback-stat">
                <div id="payback-reward" class="payback-stat-value">0</div>
                <div class="payback-stat-label">최고 리워드 비율</div>
              </div>
            </div>
          </div>
        </section>

        <section class="pre-check-section">
            <div class="check-card-container">
                <a href="exchange-guide/index.html" class="check-card">
                    <div class="card-icon-wrapper"><i class="fas fa-lightbulb"></i></div>
                    <div class="card-text">
                        <p>거래소 이용 가이드 보기</p>
                        <p class="secondary">이용 방법 자세히 알아보기</p>
                    </div>
                </a>
                <a href="payback-calculator/" class="check-card">
                    <div class="card-icon-wrapper"><i class="fas fa-calculator"></i></div>
                    <div class="card-text">
                        <p>페이백 계산하기</p>
                        <p class="secondary">내 거래 패턴으로 예상 페이백 확인하기</p>
                    </div>
                </a>
            </div>
        </section>

        <!-- 3개 그리드 카드 섹션 -->
        <section class="affiliated-cards-section">
          <a class="affiliated-card" href="lbank/">
            <div class="affiliated-card-row">
              <img class="affiliated-card-img" src="../assets/affiliatedcard/payback.png" alt="수수료 최대 65% 페이백">
              <div class="affiliated-card-content">
                <div class="affiliated-card-title">수수료 최대 <span style='color:#2563eb;'>65%</span> 페이백</div>
                <div class="affiliated-card-desc">온비트 유저 전용 특별 리워드<br>거래할수록 수수료 페이백</div>
              </div>
                    </div>
                  </a>
          <a class="affiliated-card" href="lbank/">
            <div class="affiliated-card-row">
              <img class="affiliated-card-img" src="../assets/affiliatedcard/event.png" alt="지금 가입하면 20% 리워드">
              <div class="affiliated-card-content">
                <div class="affiliated-card-title">지금 가입하면 <span style='color:#2563eb;'>20%</span> 리워드</div>
                <div class="affiliated-card-desc">신규 유저 전용 웰컴 보너스<br>가입만 하면 자동 지급</div>
                </div>
                    </div>
                  </a>
          <a class="affiliated-card" href="lbank/">
            <div class="affiliated-card-row">
              <img class="affiliated-card-img" src="../assets/affiliatedcard/lbank.png" alt="글로벌 유저들이 선택한 거래소">
              <div class="affiliated-card-content">
                <div class="affiliated-card-title"><span style='color:#2563eb;'>글로벌</span> 유저들이 선택한 거래소</div>
                <div class="affiliated-card-desc">전 세계 900만 회원<br>일일 거래량 2조 원</div>
                </div>
            </div>
          </a>
        </section>

        <section class="full-exchange-table-section">
            <div class="table-tabs swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide active" data-sort="all">전체</div>
                    <div class="swiper-slide" data-sort="recommended">추천</div>
                    <div class="swiper-slide" data-sort="event">대회/이벤트 진행중</div>
                    <div class="swiper-slide" data-sort="payback">페이백 많은</div>
                    <div class="swiper-slide" data-sort="maker">지정가 순</div>
                    <div class="swiper-slide" data-sort="taker">시장가 순</div>
                </div>
            </div>
            <div class="exchange-table-wrapper large-table">
                <div class="table-background">
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>거래소</th>
                            <th>페이백률%</th>
                            <th>지정가</th>
                            <th>시장가</th>
                            <th>1인 평균 환급금</th>
                            <th>태그</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><div class="exchange-info"><img src="../assets/tradelogo/lbanklogo.png" class="exchange-logo"><span>Lbank</span></div></td>
                            <td class="red-highlight">50%</td>
                            <td>0.0125%</td>
                            <td>0.0375%</td>
                            <td>184만원</td>
                            <td><div class="tag-cell">
                              <span class="tag v2">메인 거래소 <i class="fa-solid fa-medal"></i></span>
                          </div></td>
                            <td><button class="signup-button filled" onclick="window.location.href='lbank/'">계정 개설</button></td>
                        </tr>
                        <tr>
                          <td><div class="exchange-info"><img src="../assets/tradelogo/bitgetlogo.png" class="exchange-logo"><span>BITGET</span></div></td>
                          <td class="red-highlight">20%</td>
                          <td>0.013%</td>
                          <td>0.026%</td>
                          <td>71만원</td>
                          <td><div class="tag-cell">
                            <span class="tag v2">인기 거래소 <i class="fa-solid fa-medal"></i></span>
                        </div></td>
                          <td><button class="signup-button filled" onclick="window.location.href='bitget/'">계정 개설</button></td>
                      </tr>
                      <tr>
                        <td><div class="exchange-info"><img src="../assets/tradelogo/okxlogo.png" class="exchange-logo"><span>OKX</span></div></td>
                        <td>20%</td>
                        <td>0.016%</td>
                        <td>0.04%</td>
                        <td>84만원</td>
                        <td></td>
                        <td><button class="signup-button filled" onclick="window.location.href='okx/'">계정 개설</button></td>
                    </tr>
                        <tr>
                            <td><div class="exchange-info"><img src="../assets/tradelogo/Bitmexlogo.png" class="exchange-logo"><span>Bitmex</span></div></td>
                            <td>35%</td>
                            <td>0.01625%</td>
                            <td>0.04875%</td>
                            <td>98만원</td>
                            <td></td>
                                                            <td><button class="signup-button filled" onclick="window.location.href='bitmex/'">계정 개설</button></td>
                        </tr>
                        <tr>
                            <td><div class="exchange-info"><img src="../assets/tradelogo/blofinlogo.png" class="exchange-logo"><span>Biofin</span></div></td>
                            <td>0%</td>
                            <td>0.000%</td>
                            <td>0.000%</td>
                            <td>100만원</td>
                            <td></td>
                            <td><button class="signup-button">Comming Soon</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="partner-slider-section">
            <div class="partner-grid-header">
                <p class="partner-grid-pre-title">주요 파트너사들과 공식계약 체결</p>
                <h2 class="partner-grid-title">세계 최고의 가상 자산 거래소들과<br>함께하는 ONBit</h2>
            </div>
            <div class="partner-slider">
                <div class="partner-track" id="track1">
                    <div class="partner-logo-item"><img src="../assets/partner/lbank.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitget.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitmex.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/okx.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/tradingview.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/onbit.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/binance.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/lbank.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitget.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitmex.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/okx.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/tradingview.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/onbit.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/binance.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/lbank.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitget.png" alt="Bitget"></div>
                </div>
                <div class="partner-track" id="track2">
                    <div class="partner-logo-item"><img src="../assets/partner/lbank.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitget.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitmex.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/okx.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/tradingview.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/onbit.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/binance.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/lbank.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitget.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitmex.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/okx.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/tradingview.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/onbit.png" alt="Bitget"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/binance.png" alt="Bitmex"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/lbank.png" alt="Lbank"></div>
                    <div class="partner-logo-item"><img src="../assets/partner/bitget.png" alt="Bitget"></div>
                </div>
            </div>
        </section>
    </main>
<script>
function animateCountUp(id, target, duration, options = {}) {
  const el = document.getElementById(id);
  if (!el) return;
  let start = 0;
  const startTime = performance.now();
  const isComma = options.comma;
  const isPercent = options.percent;

  function update(now) {
    const elapsed = now - startTime;
    const progress = Math.min(elapsed / duration, 1);
    let value = Math.floor(progress * (target - start) + start);
    if (progress === 1) value = target;
    let display = value;
    if (isComma) display = value.toLocaleString();
    if (isPercent) display += '%';
    el.textContent = display;
    if (progress < 1) {
      requestAnimationFrame(update);
    }
  }
  requestAnimationFrame(update);
}

window.addEventListener('DOMContentLoaded', () => {
  animateCountUp('payback-users', 2000, 1200, { comma: false });
  animateCountUp('payback-volume', 12112621210, 1500, { comma: true });
  animateCountUp('payback-reward', 65, 1000, { percent: true });
});
</script>

    <!-- Footer=============================================== -->
    <div id="footer-placeholder"></div>

    <div id="login-modal" class="auth-modal">
      <div class="auth-modal-content">
          <span class="auth-modal-close" data-action="close-modal">&times;</span>
          <form id="login-form" class="auth-form">
              <h2>로그인</h2>
              <p id="login-error-message" class="error-message"></p>
              <div class="input-group">
                  <i class="fas fa-envelope"></i>
                  <input type="email" name="login-email" placeholder="이메일" required>
              </div>
              <div class="input-group">
                  <i class="fas fa-lock"></i>
                  <input type="password" name="login-password" placeholder="비밀번호" required>
              </div>
              <p class="find-links" style="text-align:center; margin-top:12px;">
                <a href="#" id="find-id-link">아이디(이메일) 찾기</a> | <a href="#" id="find-password-link">비밀번호 찾기</a>
              </p>
              <button type="submit" class="submit-btn">로그인</button>
              <p class="auth-form-switch">계정이 없으신가요? <a href="#" id="show-signup" data-action="show-signup">회원가입</a></p>
          </form>
      </div>
    </div>

    <div id="signup-modal" class="auth-modal">
      <div class="auth-modal-content">
          <span class="auth-modal-close" data-action="close-modal">&times;</span>
          <form id="signup-form" class="auth-form">
              <h2>회원가입</h2>
              <p id="signup-error-message" class="error-message"></p>
              <div class="input-group">
                  <i class="fas fa-user"></i>
                  <input type="text" name="signup-name" placeholder="닉네임" required>
              </div>
              <div class="input-group">
                  <i class="fas fa-envelope"></i>
                  <input type="email" name="signup-email" placeholder="이메일" required>
              </div>
              <div class="input-group">
                  <i class="fas fa-lock"></i>
                  <input type="password" name="signup-password" placeholder="비밀번호" required>
              </div>
              <div class="input-group">
                  <i class="fas fa-check-circle"></i>
                  <input type="password" name="signup-confirm-password" placeholder="비밀번호 확인" required>
              </div>
              <button type="submit" class="submit-btn">회원가입</button>
              <p class="auth-form-switch">이미 계정이 있으신가요? <a href="#" id="show-login" data-action="show-login">로그인</a></p>
          </form>
      </div>
    </div>

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
      // 페이지별 초기화 함수 정의
      function initializePage() {
        console.log('Affiliated page initialized');
        
        // 테마 변경 이벤트 리스닝
        window.addEventListener('themeChanged', (e) => {
          console.log('Affiliated page - Theme changed to:', e.detail.theme);
        });

        // Swiper 및 테이블 기능 초기화
        initializeAffiliatedFeatures();
      }

      function initializeAffiliatedFeatures() {
        const tabsSwiper = new Swiper('.table-tabs', {
          slidesPerView: 'auto',
          spaceBetween: 24,
          freeMode: true,
        });

        const tabsContainer = document.querySelector('.table-tabs .swiper-wrapper');
        const tableBody = document.querySelector('.exchange-table-wrapper tbody');
        if (tableBody) {
          const originalRows = Array.from(tableBody.querySelectorAll('tr'));
          function parseValue(text) {
            if (!text) return -Infinity;
            const parsed = parseFloat(text.replace(/[^0-9.-]+/g, ''));
            return isNaN(parsed) ? 0 : parsed;
          }
          tabsContainer.addEventListener('click', (e) => {
            const tab = e.target.closest('.swiper-slide');
            if (!tab) return;
            tabsContainer.querySelectorAll('.swiper-slide').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            const sortBy = tab.dataset.sort;
            let rowsToShow = [...originalRows];
            rowsToShow.forEach(row => {
              row.style.display = '';
              tableBody.appendChild(row);
            });
            if (sortBy === 'recommended') {
              rowsToShow.forEach(row => {
                if (!row.querySelector('.tag-cell').textContent.includes('추천')) {
                  row.style.display = 'none';
                }
              });
              return;
            }
            if (sortBy === 'event') {
              rowsToShow.forEach(row => {
                if (!row.querySelector('.tag.boost')) {
                  row.style.display = 'none';
                }
              });
              return;
            }
            let sortedRows;
            switch (sortBy) {
              case 'payback':
                sortedRows = rowsToShow.sort((a, b) => parseValue(b.children[2].textContent) - parseValue(a.children[2].textContent));
                break;
              case 'maker':
                sortedRows = rowsToShow.sort((a, b) => parseValue(a.children[4].textContent) - parseValue(b.children[4].textContent));
                break;
              case 'taker':
                sortedRows = rowsToShow.sort((a, b) => parseValue(b.children[5].textContent) - parseValue(a.children[5].textContent));
                break;
              case 'all':
              default:
                sortedRows = originalRows;
                break;
            }
            tableBody.innerHTML = '';
            sortedRows.forEach(row => {
              if(row.style.display !== 'none') {
                 tableBody.appendChild(row);
              }
            });
          });
        }
      }
    </script>
    <script src="../js/footer-loader.js" defer></script>
</body>
</html> 