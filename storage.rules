rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // ğŸ”¥ ì´ë²¤íŠ¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ ê·œì¹™
    match /events/{imageId} {
      // ëª¨ë“  ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ ì½ê¸° ê°€ëŠ¥
      allow read: if true;
      
      // ì–´ë“œë¯¼ ì‚¬ìš©ìë§Œ ì´ë¯¸ì§€ ì—…ë¡œë“œ/ì‚­ì œ ê°€ëŠ¥
      allow write, delete: if request.auth != null && 
        (firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'admin' ||
         firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.isAdmin == true);
    }
    
    // ê¸°íƒ€ ëª¨ë“  ê²½ë¡œëŠ” ì ‘ê·¼ ë¶ˆê°€
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
