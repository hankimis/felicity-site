<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Onbit - 암호화폐 거래소 정보 및 실시간 분석</title>
  <meta name="description" content="실시간 암호화폐 분석, 고래 추적, 거래소 정보를 제공하는 Onbit에서 최신 코인 시장 동향을 확인하세요.">
  
  <!-- Preconnect to external domains for faster loading -->
  <link rel="preconnect" href="https://www.gstatic.com">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://api.binance.com">
  <link rel="preconnect" href="https://s3.tradingview.com">
  <link rel="dns-prefetch" href="https://s3.tradingview.com">
  <link rel="preload" href="https://s3.tradingview.com/tv.js" as="script">
  
  <!-- Critical CSS - Inlined for faster initial render -->
  <style>
    /* Critical CSS for above-the-fold content */
    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f8fafc;
      --bg-tertiary: #f3f4f6;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
      --text-muted: #9ca3af;
      --border-light: #f1f5f9;
      --border-default: #e2e8f0;
      --border-strong: #d1d5db;
      --shadow-light: rgba(0, 0, 0, 0.08);
      --shadow-medium: rgba(0, 0, 0, 0.12);
      --accent-blue: #3b82f6;
      --positive-bg: #d1fae5;
      --positive-text: #059669;
      --negative-bg: #fee2e2;
      --negative-text: #dc2626;
    }

    [data-theme="dark"] {
      --bg-primary: #1a1a1a;
      --bg-secondary: #2a2a2a;
      --bg-tertiary: #3a3a3a;
      --text-primary: #ffffff;
      --text-secondary: #cccccc;
      --text-muted: #999999;
      --border-light: #2a2a2a;
      --border-default: #3a3a3a;
      --border-strong: #4a4a4a;
      --shadow-light: rgba(0, 0, 0, 0.4);
      --shadow-medium: rgba(0, 0, 0, 0.6);
      --accent-blue: #3b82f6;
      --positive-bg: #1a2e1a;
      --positive-text: #22c55e;
      --negative-bg: #2e1a1a;
      --negative-text: #ef4444;
    }

    /* Critical layout styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      background-color: var(--bg-primary);
      color: var(--text-primary);
      transition: background-color 0.3s ease, color 0.3s ease;
      line-height: 1.6;
    }

    .main-container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    /* Loading state for better perceived performance */
    .loading-skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }

    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* Main banner critical styles */
    .main-banner {
      background: #181c23;
      color: #f0f0f0;
      text-align: center;
      margin-bottom: 40px;
      padding: 40px 20px;
      border-radius: 12px;
      max-width: 1600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Benefits section styles */
    .benefits-container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }
    
    .benefits-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }
    
    .benefit-card-wide {
      background: var(--bg-primary);
      border-radius: 16px;
      padding: 2rem;
      text-decoration: none;
      color: var(--text-primary);
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px var(--shadow-light);
      border: 1px solid var(--border-light);
      position: relative;
      overflow: hidden;
      height: 180px;
    }
    
    .benefit-card-wide:hover {
      box-shadow: 0 8px 32px var(--shadow-medium);
      border-color: var(--border-default);
      transform: translateY(-2px);
    }
    
    .benefit-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 100%;
      position: relative;
      z-index: 2;
    }
    
    .benefit-text {
      flex: 1;
    }
    
    .benefit-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0 0 0.5rem 0;
      color: var(--text-primary);
    }
    
    .benefit-subtitle {
      font-size: 1.1rem;
      font-weight: 500;
      margin: 0 0 0.75rem 0;
      color: var(--accent-blue);
    }
    
    .benefit-description {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.4;
      margin: 0;
    }
    
    .benefit-icon {
      font-size: 4rem;
      opacity: 0.8;
      margin-left: 1rem;
    }
    
    /* Dashboard grid styles */
    .dashboard-section {
      margin: 2rem 0;
      padding: 0 1rem;
      max-width: 1800px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      grid-template-rows: 350px 350px;
      gap: 1.5rem;
      height: 720px;
    }
    
    /* 태블릿 반응형 */
    @media (min-width: 768px) and (max-width: 1024px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
        grid-template-rows: 300px 250px 250px;
        height: auto;
      }
      
      .chart-container {
        grid-column: 1;
        grid-row: 1;
      }
      
      .news-container {
        grid-column: 1;
        grid-row: 2;
      }
      
      .indices-container {
        grid-column: 1;
        grid-row: 3;
      }
    }
    
    .chart-container {
      grid-column: 1;
      grid-row: 1 / 3;
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
    }
    
    .news-container {
      grid-column: 2;
      grid-row: 1;
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
    }
    
    .indices-container {
      grid-column: 2;
      grid-row: 2;
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .dashboard-section .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border-default);
      background: var(--bg-secondary);
    }
    
    .dashboard-section .section-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .chart-controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      flex-wrap: wrap;
    }
    
    .chart-select {
      padding: 8px 12px;
      border: 1px solid var(--border-strong);
      border-radius: 8px;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 180px;
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 8px center;
      background-size: 16px;
      padding-right: 32px;
    }
    
    .chart-select:hover {
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .chart-select:focus {
      outline: none;
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    
    .chart-select option {
      padding: 8px 12px;
      background: var(--bg-primary);
      color: var(--text-primary);
    }

    /* 분봉 버튼 스타일 */
    .timeframe-buttons {
      display: flex;
      gap: 0.25rem;
      background: var(--bg-secondary);
      padding: 2px;
      border-radius: 6px;
      border: 1px solid var(--border-light);
    }

    .timeframe-btn {
      padding: 4px 8px;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-size: 11px;
      font-weight: 500;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
      min-width: 32px;
    }

    .timeframe-btn:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .timeframe-btn.active {
      background: var(--primary-color);
      color: white;
      box-shadow: 0 1px 3px rgba(59, 130, 246, 0.3);
    }
    
    .tradingview-widget-container {
      height: calc(100% - 70px);
      position: relative;
    }
    
    #tradingview_chart {
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    /* 차트 로딩 애니메이션 */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-spinner {
      animation: spin 1s linear infinite;
    }

    /* News styles */
    .news-header-controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    
    .refresh-news-btn {
      padding: 6px 8px;
      background: none;
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      cursor: pointer;
      color: var(--text-secondary);
      transition: all 0.2s ease;
    }
    
    .refresh-news-btn:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }
    
    .refresh-news-btn.loading {
      pointer-events: none;
      opacity: 0.7;
    }
    
    .view-all-news-btn {
      padding: 6px 10px;
      background: var(--accent-blue);
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .view-all-news-btn:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }
    
    .news-list {
      height: calc(100% - 70px);
      overflow-y: auto;
      padding: 1rem;
      scrollbar-width: thin;
      scrollbar-color: var(--border-strong) var(--bg-secondary);
    }
    
    .news-list::-webkit-scrollbar {
      width: 6px;
    }
    
    .news-list::-webkit-scrollbar-track {
      background: var(--bg-secondary);
      border-radius: 3px;
    }
    
    .news-list::-webkit-scrollbar-thumb {
      background: var(--border-strong);
      border-radius: 3px;
    }
    
    .news-list::-webkit-scrollbar-thumb:hover {
      background: var(--text-secondary);
    }
    
    .loading-news {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      color: var(--text-secondary);
      font-size: 14px;
      padding: 2rem;
      text-align: center;
    }
    
    .news-item {
      padding: 0.75rem;
      border-bottom: 1px solid var(--border-light);
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: 8px;
      margin-bottom: 0.5rem;
      display: flex;
      gap: 0.75rem;
    }
    
    .news-item-content {
      flex: 1;
    }
    
    .news-image {
      width: 80px;
      height: 60px;
      border-radius: 6px;
      overflow: hidden;
      flex-shrink: 0;
      background: var(--bg-tertiary);
    }
    
    .news-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.2s ease;
    }
    
    .news-item:hover .news-image img {
      transform: scale(1.05);
    }
    
    .news-item:hover {
      background: var(--bg-secondary);
      transform: translateX(4px);
      box-shadow: 0 2px 8px var(--shadow-light);
    }
    
    .news-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .news-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 13px;
      line-height: 1.4;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .news-content {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.3;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .news-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--text-muted);
    }
    
    .news-source {
      font-weight: 500;
      background: var(--bg-tertiary);
      padding: 2px 6px;
      border-radius: 4px;
      color: var(--accent-blue);
    }
    
    .news-time {
      font-size: 10px;
      opacity: 0.7;
    }
    
    /* 이벤트 카드 스타일 (뉴스와 유사한 레이아웃) */
    .event-item {
      background: var(--bg-primary);
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 0.75rem;
      transition: all 0.2s ease;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      cursor: pointer;
      display: flex;
      gap: 0.75rem;
    }
    
    .event-item:hover {
      border-color: var(--border-default);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      transform: translateY(-1px);
    }
    
    .event-item:last-child {
      margin-bottom: 0;
    }
    
    .event-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .event-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.5rem;
    }
    
    .event-info {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      flex: 1;
    }
    
    .event-title {
      font-weight: 700;
      font-size: 14px;
      color: var(--text-primary);
      line-height: 1.3;
      margin-bottom: 0.25rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .event-desc {
      font-size: 12px;
      color: var(--text-secondary);
      line-height: 1.4;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .event-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--text-muted);
    }
    
    .event-period {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 11px;
      color: var(--accent-blue);
      font-weight: 600;
    }
    
    .event-period i {
      font-size: 10px;
    }
    
    .event-exchange {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.375rem 0.75rem;
      background: var(--bg-secondary);
      border-radius: 8px;
      border: 1px solid var(--border-light);
    }
    
    .event-exchange-logo {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      object-fit: cover;
    }
    
    .event-exchange-name {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .event-image {
      width: 80px;
      height: 60px;
      border-radius: 6px;
      overflow: hidden;
      flex-shrink: 0;
      background: var(--bg-tertiary);
    }
    
    .event-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.2s ease;
      background: var(--bg-tertiary);
    }
    
    .event-item:hover .event-image img {
      transform: scale(1.05);
    }
    
    /* 이미지 로딩 상태 */
    .event-image img.loading {
      opacity: 0.6;
    }
    
    .event-image img.loaded {
      opacity: 1;
    }
    
    .event-image img.error {
      opacity: 0.3;
    }
    
    /* 이벤트 카드 더보기 버튼 스타일 */
    .events-view-all {
      display: flex;
      justify-content: center;
      padding: 1rem;
      border-top: 1px solid var(--border-light);
      margin-top: 0.5rem;
    }
    
    .events-view-all-btn {
      padding: 8px 16px;
      background: var(--accent-blue);
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .events-view-all-btn:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }
    
    /* Indices styles */
    .refresh-indices-btn {
      padding: 6px 8px;
      background: none;
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      cursor: pointer;
      color: var(--text-secondary);
      transition: all 0.2s ease;
    }
    
    .refresh-indices-btn:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }
    
    .refresh-indices-btn.loading {
      animation: spin 1s linear infinite;
    }
    
    .indices-content {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      height: calc(100% - 70px);
    }
    
    .loading-indices {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      color: var(--text-secondary);
      font-size: 14px;
      padding: 2rem;
    }
    
    .indices-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.25rem;
    }
    
    .index-item {
      background: transparent;
      border: none;
      border-radius: 8px;
      padding: 0.75rem;
      transition: all 0.2s ease;
    }
    
    .index-item:hover {
      background: var(--bg-secondary);
    }
    
    .index-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    
    .index-name {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 13px;
    }
    
    .index-symbol {
      font-size: 11px;
      color: var(--text-muted);
      background: transparent;
      padding: 0;
      border-radius: 0;
    }
    
    .index-data {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .index-price {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 14px;
    }
    
    .index-change {
      font-weight: 500;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
    }
    
    .index-change.positive {
      color: var(--positive-text);
      background: var(--positive-bg);
    }
    
    .index-change.negative {
      color: var(--negative-text);
      background: var(--negative-bg);
    }
    
    .index-change.neutral {
      color: var(--text-secondary);
      background: var(--bg-tertiary);
    }
    
    .indices-section-divider {
      margin: 1.5rem 0 0.5rem 0;
      padding-top: 0;
    }
    
    .indices-section-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.75rem;
      padding-left: 0.75rem;
    }
    
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-default);
      border-top: 2px solid var(--accent-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive design */
    @media (max-width: 1024px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
        grid-template-rows: 400px 300px 300px;
        height: auto;
      }
      
      .chart-container {
        grid-row: 1;
      }
      
      .news-container {
        grid-row: 2;
      }
      
      .indices-container {
        grid-row: 3;
      }
    }
    
    @media (max-width: 768px) {
      .benefits-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .benefit-card-wide {
        height: 160px;
        padding: 1.5rem;
      }
      
      .benefit-title {
        font-size: 1.25rem;
      }
      
      .benefit-subtitle {
        font-size: 1rem;
      }
      
      .benefit-description {
        font-size: 0.9rem;
      }
      
      .benefit-icon {
        font-size: 3rem;
      }
      
      .dashboard-section {
        padding: 0 0.5rem;
      }
      
      .dashboard-grid {
        gap: 1rem;
          grid-template-columns: 1fr;
        grid-template-rows: 300px 250px 250px;
          height: auto;
        }
        
        .chart-container {
          grid-column: 1;
          grid-row: 1;
        }
        
        .news-container {
          grid-column: 1;
          grid-row: 2;
        }
        
        .indices-container {
          grid-column: 1;
          grid-row: 3;
      }
      
      .dashboard-section .section-header {
        padding: 0.75rem 1rem;
      }
      
      .dashboard-section .section-title {
        font-size: 1rem;
        }
        
        .news-header-controls {
          gap: 0.25rem;
        }
        
        .view-all-news-btn {
          padding: 4px 8px;
          font-size: 11px;
        }
        
        .news-item {
          padding: 0.5rem;
          margin-bottom: 0.25rem;
          gap: 0.5rem;
        }
        
        .news-image {
          width: 60px;
          height: 45px;
        }
        
        .news-title {
          font-size: 12px;
        }
        
        .news-content {
          font-size: 11px;
        }
        
        .news-meta {
          font-size: 10px;
        }
        
        .news-source {
          padding: 1px 4px;
          font-size: 9px;
        }
        
        .event-item {
          padding: 0.75rem;
          margin-bottom: 0.5rem;
          gap: 0.5rem;
        }
        
        .event-title {
          font-size: 13px;
        }
        
        .event-desc {
          font-size: 11px;
        }
        
        .event-period {
          font-size: 10px;
        }
        
        .event-exchange {
          padding: 0.25rem 0.5rem;
        }
        
        .event-exchange-logo {
          width: 18px;
          height: 18px;
        }
        
        .event-exchange-name {
          font-size: 10px;
        }
        
        .event-image {
          width: 60px;
          height: 45px;
        }
        
        .events-view-all {
          padding: 0.75rem;
        }
        
        .events-view-all-btn {
          padding: 6px 12px;
          font-size: 11px;
        }
      }

    /* 실시간 추적 섹션 스타일 */
    .realtime-section {
      margin: 2rem 0;
      padding: 0 1rem;
      max-width: 1800px;
      margin-left: auto;
      margin-right: auto;
    }

    .realtime-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      height: 380px;
      align-items: stretch;
    }

    /* 공통 섹션 헤더 스타일 */
    .realtime-section .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border-default);
      background: var(--bg-secondary);
    }

    .realtime-section .section-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* 롱숏 비율 컨테이너 스타일 */
    .longshort-container {
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .longshort-controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .symbol-select {
      padding: 6px 8px;
      background: none;
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      color: var(--text-secondary);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .symbol-select:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .longshort-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 1rem;
      gap: 1rem;
    }

    .longshort-ratio-display {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 120px;
    }

    .ratio-circle {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: conic-gradient(#22c55e 0deg 187deg, #ef4444 187deg 360deg);
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .ratio-circle::before {
      content: '';
      position: absolute;
      width: 70px;
      height: 70px;
      background: var(--bg-primary);
      border-radius: 50%;
    }

    .ratio-text {
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 1;
      font-size: 12px;
      font-weight: 600;
    }

    .long-ratio {
      color: #22c55e;
    }

    .short-ratio {
      color: #ef4444;
    }

    .vs {
      color: var(--text-muted);
      font-size: 10px;
      margin: 2px 0;
    }

    .longshort-details {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
    }

    .position-info {
      flex: 1;
      padding: 0.75rem;
      border-radius: 8px;
      background: var(--bg-secondary);
    }

    .position-label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .long-info .position-label i {
      color: #22c55e;
    }

    .short-info .position-label i {
      color: #ef4444;
    }

    .position-value {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .long-info .position-value {
      color: #22c55e;
    }

    .short-info .position-value {
      color: #ef4444;
    }

    .position-amount {
      font-size: 11px;
      color: var(--text-muted);
    }

    .order-row {
      display: flex;
      justify-content: space-between;
      padding: 4px 8px;
      font-size: 12px;
      font-family: 'Courier New', monospace;
      position: relative;
      background: linear-gradient(90deg, transparent calc(100% - var(--depth-percent, 0%)), rgba(59, 130, 246, 0.1) calc(100% - var(--depth-percent, 0%)));
    }

    .order-row.ask {
      background: linear-gradient(90deg, transparent calc(100% - var(--depth-percent, 0%)), rgba(239, 68, 68, 0.1) calc(100% - var(--depth-percent, 0%)));
    }

    .order-row.bid {
      background: linear-gradient(90deg, transparent calc(100% - var(--depth-percent, 0%)), rgba(34, 197, 94, 0.1) calc(100% - var(--depth-percent, 0%)));
    }

    .order-row.ask .price {
      color: #ef4444;
    }

    .order-row.bid .price {
      color: #22c55e;
    }

    .spread-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px;
      background: var(--bg-tertiary);
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
    }

    /* 고래 거래 컨테이너 스타일 */
    .whale-container {
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .whale-controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .whale-status {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .whale-settings-btn {
      padding: 6px 8px;
      background: none;
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      cursor: pointer;
      color: var(--text-secondary);
      transition: all 0.2s ease;
      font-size: 12px;
    }

    .whale-settings-btn:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .whale-trades-container {
      flex: 1;
      padding: 0.5rem;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .whale-trades-list {
      flex: 1;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border-strong) var(--bg-secondary);
      padding: 0;
      margin: 0;
    }

    .whale-trades-list::-webkit-scrollbar {
      width: 6px;
    }

    .whale-trades-list::-webkit-scrollbar-track {
      background: var(--bg-secondary);
      border-radius: 3px;
    }

    .whale-trades-list::-webkit-scrollbar-thumb {
      background: var(--border-strong);
      border-radius: 3px;
    }

    /* 고래 거래 픽셀 퍼펙트 스타일 - 가로 배치 */
    .whale-trade-pixel {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      height: 22px;
      margin-bottom: 1px;
      padding: 2px 8px;
      border-radius: 2px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      font-weight: 600;
      color: white;
      box-sizing: border-box;
      flex-wrap: nowrap;
      white-space: nowrap;
      animation: slideDown 0.3s ease-out;
      border-left: 3px solid transparent;
    }

    /* 거래량 크기에 따른 색상 */
    .whale-trade-pixel.level-1 {
      background-color: rgba(34, 197, 94, 0.7);
      border-left-color: #22c55e;
    }

    .whale-trade-pixel.level-1.sell {
      background-color: rgba(239, 68, 68, 0.7);
      border-left-color: #ef4444;
    }

    .whale-trade-pixel.level-2 {
      background-color: rgba(34, 197, 94, 0.8);
      border-left-color: #16a34a;
      font-weight: 700;
    }

    .whale-trade-pixel.level-2.sell {
      background-color: rgba(239, 68, 68, 0.8);
      border-left-color: #dc2626;
      font-weight: 700;
    }

    .whale-trade-pixel.level-3 {
      background-color: rgba(34, 197, 94, 0.9);
      border-left-color: #15803d;
      font-weight: 700;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.3);
    }

    .whale-trade-pixel.level-3.sell {
      background-color: rgba(239, 68, 68, 0.9);
      border-left-color: #b91c1c;
      font-weight: 700;
      box-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
    }

    .whale-trade-pixel.level-4 {
      background-color: rgba(34, 197, 94, 1);
      border-left-color: #166534;
      font-weight: 700;
      box-shadow: 0 0 15px rgba(34, 197, 94, 0.5);
      animation: slideDown 0.3s ease-out, megaWhalePulse 2s infinite;
    }

    .whale-trade-pixel.level-4.sell {
      background-color: rgba(239, 68, 68, 1);
      border-left-color: #991b1b;
      font-weight: 700;
      box-shadow: 0 0 15px rgba(239, 68, 68, 0.5);
      animation: slideDown 0.3s ease-out, megaWhalePulse 2s infinite;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes megaWhalePulse {
      0%, 100% {
        box-shadow: 0 0 15px rgba(34, 197, 94, 0.5);
      }
      50% {
        box-shadow: 0 0 25px rgba(34, 197, 94, 0.8);
      }
    }

    .whale-trade-pixel .trade-arrow {
      display: inline-block;
      width: 12px;
      text-align: center;
      flex-shrink: 0;
      font-size: 11px;
    }

    .whale-trade-pixel .trade-exchange-icon {
      display: inline-block;
      width: 16px;
      text-align: center;
      flex-shrink: 0;
      margin-left: 2px;
      font-size: 12px;
      font-weight: bold;
    }

    .whale-trade-pixel .trade-price {
      display: inline-block;
      flex: 1;
      text-align: left;
      margin-left: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 13px;
    }

    .whale-trade-pixel .trade-amount {
      display: inline-block;
      flex: 1;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 13px;
      font-weight: 700;
    }

    .whale-trade-pixel .trade-time {
      display: inline-block;
      width: 28px;
      text-align: right;
      flex-shrink: 0;
      margin-left: 4px;
      font-size: 11px;
      opacity: 0.9;
    }

    /* 반응형 디자인 */
    @media (max-width: 1024px) {
      .whale-trade-pixel {
        font-size: 11px;
        height: 20px;
        padding: 2px 6px;
      }
      
      .whale-trade-pixel .trade-arrow {
        width: 10px;
        font-size: 10px;
      }
      
      .whale-trade-pixel .trade-exchange-icon {
        width: 14px;
        font-size: 11px;
      }
      
      .whale-trade-pixel .trade-price,
      .whale-trade-pixel .trade-amount {
        font-size: 11px;
      }
      
      .whale-trade-pixel .trade-time {
        width: 24px;
        font-size: 10px;
      }
    }

    @media (max-width: 768px) {
      .whale-trade-pixel {
        font-size: 10px;
        height: 18px;
        padding: 2px 4px;
      }
      
      .whale-trade-pixel .trade-arrow {
        width: 8px;
        font-size: 9px;
      }
      
      .whale-trade-pixel .trade-exchange-icon {
        width: 12px;
        font-size: 10px;
      }
      
      .whale-trade-pixel .trade-price,
      .whale-trade-pixel .trade-amount {
        font-size: 10px;
      }
      
      .whale-trade-pixel .trade-time {
        width: 20px;
        font-size: 9px;
      }
    }

    .whale-trade-card {
      background: var(--bg-secondary);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 8px;
      border-left: 4px solid transparent;
      transition: all 0.2s ease;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .whale-trade-card:hover {
      background: var(--bg-tertiary);
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .trade-main-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .trade-symbol-side {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .trade-symbol {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 14px;
    }

    .trade-side {
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .trade-side.long {
      background-color: rgba(34, 197, 94, 0.1);
      color: #22c55e;
    }

    .trade-side.short {
      background-color: rgba(239, 68, 68, 0.1);
      color: #ef4444;
    }

    .trade-time {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 500;
    }

    .trade-financial-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .trade-price, .trade-volume {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .trade-price .label, .trade-volume .label {
      font-size: 9px;
      color: var(--text-muted);
      margin-bottom: 2px;
      text-transform: uppercase;
      font-weight: 500;
    }

    .trade-price .value, .trade-volume .value {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Courier New', monospace;
    }

    .trade-exchange-info {
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: flex-end;
    }

    .exchange-icon {
      width: 16px;
      height: 16px;
      border-radius: 50%;
    }

    .exchange-name {
      font-size: 10px;
      color: var(--text-muted);
      font-weight: 500;
    }

    /* 인플루언서 포지션 컨테이너 스타일 */
    .influencer-container {
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .influencer-controls {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .more-btn {
      padding: 6px 8px;
      background: none;
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      cursor: pointer;
      color: var(--text-secondary);
      transition: all 0.2s ease;
      font-size: 12px;
      display: none !important; /* 기본적으로 완전 숨김 */
      align-items: center;
      gap: 0.25rem;
      visibility: hidden;
      opacity: 0;
    }

    .more-btn:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .more-btn.admin-visible {
      display: flex !important;
      visibility: visible !important;
      opacity: 1 !important;
    }

    .add-position-btn {
      padding: 6px 12px;
      background: var(--primary-color);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: white;
      transition: all 0.2s ease;
      font-size: 12px;
      display: none !important; /* 기본적으로 완전 숨김 */
      align-items: center;
      gap: 0.5rem;
      font-weight: 500;
      visibility: hidden;
      opacity: 0;
    }

    .add-position-btn:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }

    .add-position-btn.admin-visible {
      display: flex !important;
      visibility: visible !important;
      opacity: 1 !important;
    }

    /* 복리 계산기 스타일 */
    .compound-calculator-container {
      background: var(--bg-primary);
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .compound-calculator-content {
      flex: 1;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .calculator-form {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
      width: 100%;
      max-width: 320px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .form-row label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      text-align: center;
    }

    .form-row input {
      padding: 10px 16px;
      border: 1px solid var(--border-light);
      border-radius: 6px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 15px;
      font-weight: 500;
      transition: all 0.2s ease;
      text-align: center;
      width: 100%;
      box-sizing: border-box;
    }

    .form-row input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
    }

    .calculate-btn {
      padding: 12px 24px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 0.6rem;
      width: 100%;
      box-sizing: border-box;
    }

    .calculate-btn:hover {
      background: #2563eb;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    /* 복리 계산 결과 모달 */
    .compound-result-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      backdrop-filter: blur(4px);
    }

    .compound-result-modal.show {
      display: flex;
    }

    .modal-content-compound {
      background: var(--bg-primary);
      border-radius: 16px;
      padding: 2rem;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      color: var(--text-primary);
      border: 1px solid var(--border-light);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    }

    .modal-close-compound {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 24px;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .modal-close-compound:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .result-summary {
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid var(--border-light);
    }

    .total-profit {
      font-size: 2rem;
      font-weight: 700;
      color: #22c55e;
      margin-bottom: 0.5rem;
    }

    .final-amount {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .result-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    .result-table th,
    .result-table td {
      padding: 8px 12px;
      text-align: center;
      border-bottom: 1px solid var(--border-light);
      font-size: 14px;
    }

    .result-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-secondary);
    }

    .result-table td {
      color: var(--text-primary);
    }

    .result-table .profit-cell {
      color: #22c55e;
      font-weight: 600;
    }

    .result-table .amount-cell {
      font-weight: 600;
    }

    .result-table .percent-cell {
      color: #fbbf24;
      font-weight: 600;
    }

    .modal-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border-light);
    }

    .btn-secondary-compound {
      padding: 10px 20px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-light);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-secondary-compound:hover {
      background: var(--bg-tertiary);
      border-color: var(--border-default);
    }

    .btn-primary-compound {
      padding: 10px 20px;
      background: #22c55e;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-primary-compound:hover {
      background: #16a34a;
    }

    @media (max-width: 768px) {
      .compound-calculator-container {
        height: 100%;
      }
      
      .compound-calculator-content {
        padding: 0.75rem;
      }
      
      .calculator-form {
        gap: 0.5rem;
        max-width: 280px;
        padding: 0 0.75rem;
      }
      
      .form-row input {
        padding: 8px 14px;
        font-size: 14px;
      }
      
      .form-row label {
        font-size: 11px;
      }
      
      .calculate-btn {
        padding: 10px 20px;
        font-size: 13px;
      }
      
      .modal-content-compound {
        margin: 1rem;
        padding: 1.5rem;
      }
      
      .result-table {
        font-size: 12px;
      }
      
      .result-table th,
      .result-table td {
        padding: 6px 8px;
      }
    }

    .influencer-positions-container {
      flex: 1;
      padding: 1rem;
    }

    .positions-list {
      max-height: 240px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--border-strong) var(--bg-secondary);
    }

    .positions-list::-webkit-scrollbar {
      width: 6px;
    }

    .positions-list::-webkit-scrollbar-track {
      background: var(--bg-secondary);
      border-radius: 3px;
    }

            .positions-list::-webkit-scrollbar-thumb {
          background: var(--border-strong);
          border-radius: 3px;
        }

        /* 인플루언서 포지션 상세 스타일 */
        .position-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 8px;
        }

        .position-main-info {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 8px;
          padding: 8px;
          background: var(--bg-tertiary);
          border-radius: 6px;
        }

        .position-symbol-side {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .position-symbol-side .symbol {
          font-weight: 600;
          color: var(--text-primary);
          font-size: 14px;
        }

        .position-symbol-side .side {
          padding: 2px 8px;
          border-radius: 12px;
          font-size: 10px;
          font-weight: 600;
          text-transform: uppercase;
        }

        .position-symbol-side .side.long {
          background-color: rgba(34, 197, 94, 0.1);
          color: #22c55e;
        }

        .position-symbol-side .side.short {
          background-color: rgba(239, 68, 68, 0.1);
          color: #ef4444;
        }

        .position-leverage {
          display: flex;
          flex-direction: column;
          align-items: flex-end;
        }

        .leverage-label {
          font-size: 9px;
          color: var(--text-muted);
          margin-bottom: 2px;
        }

        .leverage-value {
          font-size: 12px;
          font-weight: 600;
          color: var(--accent-blue);
        }

        .detail-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 4px 0;
          border-bottom: 1px solid var(--border-light);
        }

        .detail-row:last-child {
          border-bottom: none;
        }

        .detail-row .label {
          font-size: 10px;
          color: var(--text-muted);
          font-weight: 500;
        }

        .detail-row .value {
          font-size: 11px;
          font-weight: 600;
          color: var(--text-primary);
          font-family: 'Courier New', monospace;
        }

        .detail-row .value.positive {
          color: #22c55e;
        }

        .detail-row .value.negative {
          color: #ef4444;
        }

        .detail-row .value.liquidation-price {
          color: #f59e0b;
        }

        .edit-position-btn {
          background: none;
          border: 1px solid var(--border-strong);
          border-radius: 4px;
          padding: 4px 8px;
          cursor: pointer;
          color: var(--text-muted);
          font-size: 12px;
          transition: all 0.2s ease;
        }

        .edit-position-btn:hover {
          background: var(--bg-tertiary);
          color: var(--text-primary);
        }

        /* 모달 스타일 */
        .position-edit-modal,
        .positions-view-modal,
        .admin-menu {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 1000;
        }

        .modal-overlay,
        .admin-menu-overlay {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.6);
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .modal-content {
          background: var(--bg-primary);
          border-radius: 12px;
          width: 90%;
          max-width: 500px;
          max-height: 80vh;
          overflow-y: auto;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-content.large {
          max-width: 800px;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 20px;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h3 {
          margin: 0;
          color: var(--text-primary);
        }

        .modal-close {
          background: none;
          border: none;
          font-size: 24px;
          color: var(--text-muted);
          cursor: pointer;
          padding: 0;
          width: 30px;
          height: 30px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .modal-body {
          padding: 20px;
        }

        .modal-footer {
          display: flex;
          justify-content: flex-end;
          gap: 10px;
          padding: 20px;
          border-top: 1px solid var(--border-light);
        }

        .form-group {
          margin-bottom: 15px;
        }

        .form-group label {
          display: block;
          margin-bottom: 5px;
          color: var(--text-secondary);
          font-size: 14px;
          font-weight: 500;
        }

        .form-group input,
        .form-group select {
          width: 100%;
          padding: 8px 12px;
          border: 1px solid var(--border-strong);
          border-radius: 6px;
          background: var(--bg-secondary);
          color: var(--text-primary);
          font-size: 14px;
        }

        .form-group input:focus,
        .form-group select:focus {
          outline: none;
          border-color: var(--accent-blue);
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 8px 16px;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          font-size: 14px;
          font-weight: 500;
          transition: all 0.2s ease;
        }

        .btn-primary {
          background: var(--accent-blue);
          color: white;
        }

        .btn-primary:hover {
          background: #2563eb;
        }

        .btn-secondary {
          background: var(--bg-tertiary);
          color: var(--text-secondary);
        }

        .btn-secondary:hover {
          background: var(--border-strong);
        }

        .btn-danger {
          background: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background: #dc2626;
        }

        .admin-menu-content {
          background: var(--bg-primary);
          border-radius: 12px;
          padding: 20px;
          min-width: 250px;
        }

        .admin-menu-content h4 {
          margin: 0 0 15px 0;
          color: var(--text-primary);
        }

        .admin-menu-content button {
          display: block;
          width: 100%;
          padding: 10px;
          margin-bottom: 8px;
          background: var(--bg-secondary);
          border: 1px solid var(--border-strong);
          border-radius: 6px;
          color: var(--text-primary);
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .admin-menu-content button:hover {
          background: var(--bg-tertiary);
        }

        .positions-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 15px;
        }

    /* 인플루언서 포지션 카드 - 깔끔한 스타일 */
    .influencer-position-card {
      background: var(--bg-primary);
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      position: relative;
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .influencer-position-card:hover {
      border-color: var(--border-default);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
      transform: translateY(-1px);
    }

    .influencer-position-card.clickable {
      cursor: pointer;
    }

    .influencer-position-card.clickable:hover {
      border-color: var(--primary-color);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    }

    .influencer-position-card:last-child {
      margin-bottom: 0;
    }

    /* 헤더: 트레이더 정보 + 상태 */
    .position-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .trader-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .trader-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-light);
    }

    .trader-details {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .trader-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1;
    }

    .position-time {
      font-size: 11px;
      color: var(--text-muted);
      line-height: 1;
    }

    .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #6b7280;
    }

    .status-indicator.online {
      background: #22c55e;
      box-shadow: 0 0 6px rgba(34, 197, 94, 0.4);
    }

    /* 메인: 심볼/포지션 + 손익 */
    .position-main {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .symbol-side {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .symbol {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .side-badge {
      padding: 3px 8px;
      border-radius: 6px;
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .side-badge.long {
      background: rgba(34, 197, 94, 0.15);
      color: #16a34a;
      border: 1px solid rgba(34, 197, 94, 0.2);
    }

    .side-badge.short {
      background: rgba(239, 68, 68, 0.15);
      color: #dc2626;
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .leverage {
      font-size: 11px;
      color: var(--text-secondary);
      background: var(--bg-tertiary);
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 500;
    }

    .pnl-display {
      text-align: right;
    }

    .pnl-amount {
      font-size: 16px;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      line-height: 1;
      margin-bottom: 2px;
    }

    .pnl-percent {
      font-size: 12px;
      font-weight: 600;
      font-family: 'Courier New', monospace;
      line-height: 1;
    }

    .pnl-amount.positive,
    .pnl-percent.positive {
      color: #22c55e;
    }

    .pnl-amount.negative,
    .pnl-percent.negative {
      color: #ef4444;
    }

    /* 상세 정보: 가격들 */
    .position-details {
      border-top: 1px solid var(--border-light);
      padding-top: 12px;
    }

    .price-info {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
    }

    .price-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .price-item .label {
      font-size: 10px;
      color: var(--text-muted);
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .price-item .value {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      font-family: 'Courier New', monospace;
    }

    .price-item.liquidation .label {
      color: #f59e0b;
    }

    .price-item.liquidation .value {
      color: #f59e0b;
    }

    .realtime-price {
      animation: priceUpdate 0.5s ease-in-out;
    }

    @keyframes priceUpdate {
      0% { background-color: rgba(34, 197, 94, 0.2); }
      100% { background-color: transparent; }
    }

    /* 어드민 편집 버튼 */
    .admin-edit-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: rgba(0, 0, 0, 0.05);
      border: 1px solid var(--border-light);
      color: var(--text-muted);
      cursor: pointer;
      font-size: 12px;
      padding: 4px 6px;
      border-radius: 4px;
      opacity: 0.6;
      transition: all 0.2s ease;
    }

    .admin-edit-btn:hover {
      opacity: 1;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border-color: var(--border-default);
    }

    /* 반응형 디자인 - 인플루언서 포지션 카드 */
    @media (max-width: 768px) {
      .influencer-position-card {
        padding: 12px;
        margin-bottom: 8px;
      }

      .trader-avatar {
        width: 32px;
        height: 32px;
      }

      .trader-name {
        font-size: 13px;
      }

      .position-time {
        font-size: 10px;
      }

      .symbol {
        font-size: 14px;
      }

      .side-badge {
        font-size: 9px;
        padding: 2px 6px;
      }

      .leverage {
        font-size: 10px;
      }

      .pnl-amount {
        font-size: 14px;
      }

      .pnl-percent {
        font-size: 11px;
      }

      .price-info {
        gap: 8px;
      }

      .price-item .label {
        font-size: 9px;
      }

      .price-item .value {
        font-size: 11px;
      }
    }

    /* 이미지 업로드 스타일 */
    .image-upload-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }

    .avatar-preview {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-light);
    }

    .image-upload-container input[type="file"] {
      padding: 8px;
      border: 1px solid var(--border-light);
      border-radius: 4px;
      background: var(--bg-secondary);
      color: var(--text-primary);
    }

    .image-upload-container button {
      padding: 6px 12px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-light);
      border-radius: 4px;
      color: var(--text-primary);
      cursor: pointer;
      font-size: 12px;
    }

    .image-upload-container button:hover {
      background: var(--bg-secondary);
      border-color: var(--border-default);
    }

    /* 어드민 카드 메뉴 스타일 */
    .admin-card-menu {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 10000;
    }

    .admin-menu-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .admin-menu-content {
      background: var(--bg-primary);
      border: 1px solid var(--border-default);
      border-radius: 12px;
      padding: 24px;
      min-width: 300px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .admin-menu-content h4 {
      margin: 0 0 16px 0;
      color: var(--text-primary);
      font-size: 16px;
      font-weight: 600;
      text-align: center;
    }

    .menu-buttons {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .menu-buttons button {
      padding: 12px 16px;
      border: 1px solid var(--border-light);
      border-radius: 8px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s ease;
      text-align: left;
    }

    .menu-buttons button:hover {
      background: var(--bg-tertiary);
      border-color: var(--border-default);
      transform: translateY(-1px);
    }

    .menu-buttons button:last-child {
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      text-align: center;
      margin-top: 8px;
    }

    .menu-buttons button:last-child:hover {
      background: var(--bg-secondary);
    }

    /* 어드민 포지션 편집 모달 */
    .position-edit-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
    }

    .position-edit-modal .modal-overlay {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .position-edit-modal .modal-content {
      background: var(--bg-secondary);
      border-radius: 12px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .position-edit-modal .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      border-bottom: 1px solid var(--border-light);
    }

    .position-edit-modal .modal-header h3 {
      margin: 0;
      color: var(--text-primary);
      font-size: 18px;
      font-weight: 600;
    }

    .position-edit-modal .modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s;
    }

    .position-edit-modal .modal-close:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .position-edit-modal .modal-body {
      padding: 20px;
    }

    .position-edit-modal .form-group {
      margin-bottom: 16px;
    }

    .position-edit-modal .form-group label {
      display: block;
      margin-bottom: 6px;
      color: var(--text-primary);
      font-weight: 500;
      font-size: 14px;
    }

    .position-edit-modal .form-group input,
    .position-edit-modal .form-group select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border-light);
      border-radius: 6px;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 14px;
      transition: border-color 0.2s;
    }

    .position-edit-modal .form-group input:focus,
    .position-edit-modal .form-group select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
    }

    .position-edit-modal .form-group input[type="checkbox"] {
      width: auto;
      margin-right: 8px;
    }

    .position-edit-modal .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      padding: 20px;
      border-top: 1px solid var(--border-light);
    }

    .position-edit-modal .btn-primary,
    .position-edit-modal .btn-secondary,
    .position-edit-modal .btn-danger {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .position-edit-modal .btn-primary {
      background: var(--primary-color);
      color: white;
    }

    .position-edit-modal .btn-primary:hover {
      background: var(--primary-dark);
    }

    .position-edit-modal .btn-secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border: 1px solid var(--border-light);
    }

    .position-edit-modal .btn-secondary:hover {
      background: var(--bg-quaternary);
    }

    .position-edit-modal .btn-danger {
      background: #dc2626;
      color: white;
    }

    .position-edit-modal .btn-danger:hover {
      background: #b91c1c;
    }

    /* 모달 스타일 */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: var(--bg-primary);
      border-radius: 16px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem;
      border-bottom: 1px solid var(--border-default);
      background: var(--bg-secondary);
    }

    .modal-header h2 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 2rem;
      color: var(--text-secondary);
      cursor: pointer;
      padding: 0;
      line-height: 1;
      transition: color 0.2s;
    }

    .modal-close:hover {
      color: var(--text-primary);
    }

    .modal-body {
      padding: 1.5rem;
      max-height: 60vh;
      overflow-y: auto;
    }

    .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border-default);
      background: var(--bg-secondary);
      text-align: right;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-primary {
      background: var(--accent-blue);
      color: white;
    }

    .btn-primary:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }

    /* 코인 테이블 스타일 */
    .crypto-table-section {
      margin: 2rem 0;
      padding: 0 1rem;
      max-width: 1800px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .crypto-table-section .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding: 1rem 1.5rem;
      background: var(--bg-primary);
      border-radius: 12px 12px 0 0;
      border-bottom: 1px solid var(--border-default);
    }
    
    .crypto-table-section .section-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .crypto-table-section .section-title i {
      color: var(--accent-blue);
      font-size: 1.1rem;
    }
    
    .table-controls {
      display: flex;
      gap: 1rem;
      align-items: center;
    }
    
    .search-box {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .search-box i {
      position: absolute;
      left: 12px;
      color: var(--text-secondary);
      z-index: 1;
    }
    
    .search-box input {
      padding: 8px 12px 8px 35px;
      border: 1px solid var(--border-strong);
      border-radius: 8px;
      font-size: 14px;
      width: 200px;
      background: var(--bg-primary);
      color: var(--text-primary);
      transition: all 0.2s ease;
    }
    
    .search-box input:focus {
      outline: none;
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .search-box input::placeholder {
      color: var(--text-muted);
    }
    
    .refresh-btn {
      padding: 8px 12px;
      background: var(--accent-blue);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .refresh-btn:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }
    
    .refresh-btn.loading {
      animation: spin 1s linear infinite;
    }
    
    .crypto-table-wrapper {
      background: var(--bg-primary);
      border-radius: 0 0 12px 12px;
      box-shadow: 0 4px 20px var(--shadow-light);
      overflow: hidden;
      border: 1px solid var(--border-default);
      border-top: none;
    }
    
    .table-tabs {
      display: flex;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-default);
      padding: 0 1rem;
    }
    
    .tab-btn {
      padding: 12px 20px;
      background: none;
      border: none;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
    }
    
    .tab-btn.active {
      color: var(--accent-blue);
      border-bottom-color: var(--accent-blue);
    }
    
    .tab-btn:hover {
      color: var(--accent-blue);
    }
    
    .crypto-table-container {
      overflow-x: auto;
    }
    
    .crypto-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      table-layout: fixed;
    }
    
    /* 컬럼 너비 고정 */
    .rank-col { width: 5%; }
    .name-col { width: 11%; }
    .price-col { width: 8%; }
    .change-col { width: 7%; }
    .funding-col { width: 7%; }
    .volume-col { width: 8%; }
    .oi-col { width: 7%; }
    .oi-change-col { width: 6%; }
    .market-col { width: 8%; }
    .liquidation-col { width: 7%; }
    .chart-col { width: 7%; }
    
    .crypto-table th {
      background: var(--bg-secondary);
      padding: 12px 8px;
      text-align: center;
      font-weight: 600;
      color: var(--text-primary);
      border-bottom: 1px solid var(--border-default);
      white-space: nowrap;
      font-size: 13px;
    }
    
    .crypto-table th.name-col {
      text-align: left;
    }
    
    .crypto-table th.price-col,
    .crypto-table th.volume-col,
    .crypto-table th.oi-col,
    .crypto-table th.market-col,
    .crypto-table th.liquidation-col {
      text-align: right;
    }
    
    .crypto-table th.sortable {
      cursor: pointer;
      user-select: none;
      position: relative;
    }
    
    .crypto-table th.sortable:hover {
      background: var(--bg-tertiary);
    }
    
    .crypto-table th.sortable::after {
      content: '⇅';
      margin-left: 3px;
      opacity: 0.4;
      font-size: 12px;
      font-weight: normal;
    }
    
    .crypto-table th.sort-asc::after {
      content: '▲';
      opacity: 0.8;
      color: var(--accent-blue);
    }
    
    .crypto-table th.sort-desc::after {
      content: '▼';
      opacity: 0.8;
      color: var(--accent-blue);
    }
    
    .crypto-table td {
      padding: 12px 8px;
      border-bottom: 1px solid var(--border-light);
      vertical-align: middle;
      text-align: center;
      font-size: 13px;
      color: var(--text-primary);
    }
    
    .crypto-table td:nth-child(2) {
      text-align: left;
    }
    
    .crypto-table td:nth-child(3),
    .crypto-table td:nth-child(7),
    .crypto-table td:nth-child(8),
    .crypto-table td:nth-child(11),
    .crypto-table td:nth-child(12),
    .crypto-table td:nth-child(13) {
      text-align: right;
    }
    
    .crypto-table tr:hover {
      background: var(--bg-secondary);
    }
    
    .coin-info {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .coin-logo {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    
    .coin-details {
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    
    .coin-name {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 13px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .coin-symbol {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 500;
    }
    
    .price {
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .change {
      font-weight: 500;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 13px;
    }
    
    .change.positive {
      color: var(--positive-text);
      background: var(--positive-bg);
    }
    
    .change.negative {
      color: var(--negative-text);
      background: var(--negative-bg);
    }
    
    .change.neutral {
      color: var(--text-secondary);
      background: var(--bg-tertiary);
    }
    
    .volume, .market-cap {
      font-weight: 500;
      color: var(--text-primary);
    }
    
    .mini-chart {
      width: 60px;
      height: 30px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    
    .mini-chart:hover {
      transform: scale(1.05);
    }
    
    .table-pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: var(--bg-secondary);
    }
    
    .page-btn {
      padding: 8px 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .page-btn:hover:not(:disabled) {
      background: var(--bg-tertiary);
      border-color: var(--text-muted);
    }
    
    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .page-info {
      font-size: 14px;
      color: var(--text-secondary);
    }
    
    .loading-row {
      text-align: center;
      padding: 2rem;
      color: var(--text-secondary);
    }

    /* 반응형 디자인 */
    @media (max-width: 1024px) {
      .realtime-grid {
        grid-template-columns: 1fr;
        height: auto;
        gap: 1rem;
      }
      
      .longshort-container,
      .whale-container,
      .compound-calculator-container {
        height: 340px;
      }
    }

    @media (min-width: 768px) and (max-width: 1024px) {
      .realtime-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .influencer-container {
        grid-column: 1 / -1;
      }
    }

    @media (max-width: 768px) {
      .realtime-section {
        padding: 0 0.5rem;
      }
      
      .realtime-grid {
        gap: 0.75rem;
        height: auto;
      }
      
      .longshort-container,
      .whale-container,
      .compound-calculator-container {
        height: 320px;
      }
      
      .longshort-content,
      .whale-trades-container,
      .influencer-positions-container {
        padding: 0.75rem;
      }
      
      .whale-trades-list,
      .positions-list {
        max-height: 180px;
      }
      
      .modal-content {
        width: 95%;
        margin: 1rem;
      }
      
      .modal-header,
      .modal-body,
      .modal-footer {
        padding: 1rem;
      }
      
             /* 모바일 코인 테이블 최적화 */
       .crypto-table-section {
         padding: 0 0.5rem;
       }
       
       .crypto-table-section .section-header {
         flex-direction: column;
         align-items: stretch;
         gap: 1rem;
         margin-bottom: 0;
         padding: 1rem;
         border-radius: 12px 12px 0 0;
       }
       
       .crypto-table-section .section-title {
         font-size: 1.1rem;
         justify-content: center;
       }
       
       .crypto-table-section .section-title i {
         font-size: 1rem;
       }
      
      .table-controls {
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .search-box {
        width: 100%;
      }
      
      .search-box input {
        width: 100%;
      }
      
      .refresh-btn {
        align-self: center;
        padding: 10px 20px;
      }
      
      /* 모바일 테이블 슬라이드 컨테이너 */
      .crypto-table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
        scrollbar-width: thin;
        scrollbar-color: var(--accent-blue) transparent;
      }
      
      .crypto-table-container::-webkit-scrollbar {
        height: 4px;
      }
      
      .crypto-table-container::-webkit-scrollbar-track {
        background: var(--bg-secondary);
        border-radius: 2px;
      }
      
      .crypto-table-container::-webkit-scrollbar-thumb {
        background: var(--accent-blue);
        border-radius: 2px;
      }
      
      .crypto-table-container::-webkit-scrollbar-thumb:hover {
        background: #2563eb;
      }
      
      /* 모바일 테이블 최소 너비 설정 */
      .crypto-table {
        min-width: 900px;
        font-size: 12px;
      }
      
      .crypto-table th,
      .crypto-table td {
        padding: 8px 4px;
        font-size: 11px;
        white-space: nowrap;
      }
      
      .crypto-table th {
        position: sticky;
        top: 0;
        background: var(--bg-secondary);
        z-index: 10;
        border-bottom: 2px solid var(--border-default);
      }
      
      /* 모바일에서 중요한 컬럼만 표시 */
      .crypto-table .rank-col { width: 40px; }
      .crypto-table .name-col { width: 120px; }
      .crypto-table .price-col { width: 80px; }
      .crypto-table .change-col { width: 70px; }
      .crypto-table .funding-col { width: 70px; }
      .crypto-table .volume-col { width: 80px; }
      .crypto-table .oi-col { width: 80px; }
      .crypto-table .oi-change-col { width: 60px; }
      .crypto-table .market-col { width: 90px; }
      .crypto-table .liquidation-col { width: 80px; }
      .crypto-table .chart-col { width: 60px; }
      
      .coin-logo {
        width: 24px;
        height: 24px;
      }
      
      .coin-name {
        font-size: 11px;
      }
      
      .coin-symbol {
        font-size: 9px;
      }
      
      .change {
        padding: 2px 4px;
        font-size: 10px;
      }
      
      .mini-chart {
        width: 40px;
        height: 20px;
      }
      
      /* 모바일 테이블 탭 최적화 */
      .table-tabs {
        padding: 0 0.5rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      
      .table-tabs::-webkit-scrollbar {
        display: none;
      }
      
      .tab-btn {
        padding: 8px 16px;
        font-size: 13px;
        white-space: nowrap;
        flex-shrink: 0;
      }
      
      /* 모바일 페이지네이션 */
      .table-pagination {
        flex-direction: column;
        gap: 0.5rem;
        padding: 0.75rem;
      }
      
      .page-btn {
        padding: 8px 12px;
        font-size: 12px;
        min-width: 60px;
      }
      
      .page-info {
        font-size: 12px;
        order: -1;
      }
      
      /* 모바일 스크롤 힌트 */
      .crypto-table-wrapper::after {
        content: "← 좌우로 스크롤하여 더 많은 정보를 확인하세요 →";
        display: block;
        text-align: center;
        padding: 8px;
        font-size: 11px;
        color: var(--text-muted);
        background: var(--bg-secondary);
        border-top: 1px solid var(--border-light);
      }
    }
    
         /* 초소형 모바일 (360px 이하) */
     @media (max-width: 360px) {
       .crypto-table-section {
         padding: 0 0.25rem;
       }
       
       .crypto-table-section .section-header {
         padding: 0.75rem;
       }
       
       .crypto-table-section .section-title {
         font-size: 1rem;
       }
       
       .crypto-table-section .section-title i {
         font-size: 0.9rem;
       }
      
      .crypto-table {
        min-width: 800px;
        font-size: 11px;
      }
      
      .crypto-table th,
      .crypto-table td {
        padding: 6px 3px;
        font-size: 10px;
      }
      
      .crypto-table .rank-col { width: 35px; }
      .crypto-table .name-col { width: 100px; }
      .crypto-table .price-col { width: 70px; }
      .crypto-table .change-col { width: 60px; }
      .crypto-table .funding-col { width: 60px; }
      .crypto-table .volume-col { width: 70px; }
      .crypto-table .oi-col { width: 70px; }
      .crypto-table .oi-change-col { width: 50px; }
      .crypto-table .market-col { width: 80px; }
      .crypto-table .liquidation-col { width: 70px; }
      .crypto-table .chart-col { width: 50px; }
      
      .coin-logo {
        width: 20px;
        height: 20px;
      }
      
      .coin-name {
        font-size: 10px;
      }
      
      .coin-symbol {
        font-size: 8px;
      }
      
      .change {
        padding: 1px 3px;
        font-size: 9px;
      }
      
      .mini-chart {
        width: 35px;
        height: 18px;
      }
    }
    
    .crypto-table th.sort-asc::after {
      content: '▲';
      opacity: 0.8;
      color: var(--accent-blue);
    }
    
    .crypto-table th.sort-desc::after {
      content: '▼';
      opacity: 0.8;
      color: var(--accent-blue);
    }
    
    .crypto-table td {
      padding: 12px 8px;
      border-bottom: 1px solid var(--border-light);
      vertical-align: middle;
      text-align: center;
      font-size: 13px;
      color: var(--text-primary);
    }
    
    .crypto-table td:nth-child(2) {
      text-align: left;
    }
    
    .crypto-table td:nth-child(3),
    .crypto-table td:nth-child(7),
    .crypto-table td:nth-child(8),
    .crypto-table td:nth-child(11),
    .crypto-table td:nth-child(12),
    .crypto-table td:nth-child(13) {
      text-align: right;
    }
    
    .crypto-table tr:hover {
      background: var(--bg-secondary);
    }
    
    .coin-info {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .coin-logo {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    
    .coin-details {
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    
    .coin-name {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 13px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .coin-symbol {
      font-size: 11px;
      color: var(--text-secondary);
      font-weight: 500;
    }
    
    .price {
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .change {
      font-weight: 500;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 13px;
    }
    
    .change.positive {
      color: var(--positive-text);
      background: var(--positive-bg);
    }
    
    .change.negative {
      color: var(--negative-text);
      background: var(--negative-bg);
    }
    
    .change.neutral {
      color: var(--text-secondary);
      background: var(--bg-tertiary);
    }
    
    .volume, .market-cap {
      font-weight: 500;
      color: var(--text-primary);
    }
    
    .mini-chart {
      width: 60px;
      height: 30px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    
    .mini-chart:hover {
      transform: scale(1.05);
    }
    
    .table-pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: var(--bg-secondary);
    }
    
    .page-btn {
      padding: 8px 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border-strong);
      border-radius: 6px;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .page-btn:hover:not(:disabled) {
      background: var(--bg-tertiary);
      border-color: var(--text-muted);
    }
    
    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .page-info {
      font-size: 14px;
      color: var(--text-secondary);
    }
    
    .loading-row {
      text-align: center;
      padding: 2rem;
      color: var(--text-secondary);
    }
  </style>
  
  <!-- Favicon and icons -->
  <link rel="icon" type="image/png" href="/onbit/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/onbit/favicon.svg" />
  <link rel="shortcut icon" href="/onbit/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/onbit/apple-touch-icon.png" />
  <link rel="manifest" href="/onbit/site.webmanifest" />
  
  <!-- Load critical CSS files -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="auth.css">
  
  <!-- Preload critical fonts -->
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard-dynamic-subset.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard-dynamic-subset.css"></noscript>
  
  <!-- Defer Font Awesome -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"></noscript>

  <!-- Critical scripts that must load immediately -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
  <script src="https://s3.tradingview.com/tv.js" async defer></script>
</head>
<body>
  <!-- Header placeholder -->
  <div id="header-placeholder"></div>
  
    <!-- 실시간 추적 섹션 -->
    <section class="realtime-section">
      <div class="realtime-grid">
        <!-- 실시간 롱숏 비율 -->
        <div class="longshort-container">
          <div class="section-header">
            <h3 class="section-title">
              <i class="fas fa-chart-pie"></i>
              실시간 롱숏 비율
            </h3>
            <div class="longshort-controls">
              <select id="longshort-symbol" class="symbol-select">
                <option value="BTCUSDT">BTC/USDT</option>
                <option value="ETHUSDT">ETH/USDT</option>
                <option value="ADAUSDT">ADA/USDT</option>
                <option value="SOLUSDT">SOL/USDT</option>
                <option value="XRPUSDT">XRP/USDT</option>
              </select>
              </div>
            </div>
          <div class="longshort-content">
            <div class="longshort-ratio-display">
              <div class="ratio-circle" id="ratio-circle">
                <div class="ratio-text">
                  <span class="long-ratio" id="long-ratio">52%</span>
                  <span class="vs">vs</span>
                  <span class="short-ratio" id="short-ratio">48%</span>
              </div>
            </div>
            </div>
            <div class="longshort-details">
              <div class="position-info long-info">
                <div class="position-label">
                  <i class="fas fa-arrow-up"></i>
                  <span>롱 포지션</span>
                </div>
                <div class="position-value" id="long-percentage">52.3%</div>
                <div class="position-amount" id="long-amount">$1,234,567</div>
              </div>
              <div class="position-info short-info">
                <div class="position-label">
                  <i class="fas fa-arrow-down"></i>
                  <span>숏 포지션</span>
                </div>
                <div class="position-value" id="short-percentage">47.7%</div>
                <div class="position-amount" id="short-amount">$987,654</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 실시간 고래 거래 -->
        <div class="whale-container">
          <div class="section-header">
            <h3 class="section-title">
              <i class="fas fa-fish"></i>
              실시간 고래 거래
            </h3>
            <div class="whale-controls">
              <span class="whale-status">연결 중...</span>
              <button class="whale-settings-btn" id="whale-settings-btn">
                <i class="fas fa-cog"></i>
              </button>
            </div>
          </div>
          <div class="whale-trades-container" id="whale-trades-container">
            <div class="whale-trades-list">
              <!-- 고래 거래 데이터가 여기에 동적으로 추가됩니다 -->
            </div>
          </div>
        </div>
        
        <!-- 복리 계산기 -->
        <div class="compound-calculator-container">
          <div class="section-header">
            <h3 class="section-title">
              <i class="fas fa-calculator"></i>
              복리 계산기
            </h3>
          </div>
          <div class="compound-calculator-content">
            <div class="calculator-form">
              <div class="form-row">
                <label for="initial-amount">초기 금액 (₩)</label>
                <input type="text" id="initial-amount" value="1,000,000" placeholder="1,000,000">
              </div>
              <div class="form-row">
                <label for="investment-years">복리 횟수 (기간)</label>
                <input type="number" id="investment-years" value="20" min="1" max="50">
              </div>
              <div class="form-row">
                <label for="annual-return">수익률 (%)</label>
                <input type="text" id="annual-return" value="5%" placeholder="5%">
              </div>
              <button class="calculate-btn" id="calculate-btn">
                계산하기
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 차트 및 정보 섹션 -->
    <section class="dashboard-section">
      <div class="dashboard-grid">
        <!-- 차트 영역 -->
        <div class="chart-container">
          <div class="section-header">
            <h3 class="section-title">실시간 차트</h3>
            <div class="chart-controls">
              <select id="chart-symbol" class="chart-select">
                <option value="BTCUSDT">Bitcoin (BTC)</option>
                <option value="ETHUSDT">Ethereum (ETH)</option>
                <option value="BNBUSDT">BNB (BNB)</option>
                <option value="SOLUSDT">Solana (SOL)</option>
                <option value="ADAUSDT">Cardano (ADA)</option>
                <option value="XRPUSDT">XRP (XRP)</option>
                <option value="DOGEUSDT">Dogecoin (DOGE)</option>
                <option value="AVAXUSDT">Avalanche (AVAX)</option>
                <option value="DOTUSDT">Polkadot (DOT)</option>
                <option value="MATICUSDT">Polygon (MATIC)</option>
                <option value="LINKUSDT">Chainlink (LINK)</option>
                <option value="UNIUSDT">Uniswap (UNI)</option>
                <option value="LTCUSDT">Litecoin (LTC)</option>
                <option value="BCHUSDT">Bitcoin Cash (BCH)</option>
                <option value="ATOMUSDT">Cosmos (ATOM)</option>
              </select>
              <div class="timeframe-buttons">
                <button class="timeframe-btn active" data-timeframe="1">1분</button>
                <button class="timeframe-btn" data-timeframe="5">5분</button>
                <button class="timeframe-btn" data-timeframe="15">15분</button>
                <button class="timeframe-btn" data-timeframe="60">1시간</button>
                <button class="timeframe-btn" data-timeframe="240">4시간</button>
                <button class="timeframe-btn" data-timeframe="1D">1일</button>
              </div>
            </div>
          </div>
          <div class="tradingview-widget-container">
          <div id="tradingview_chart">
            <!-- 차트 로딩 중 표시 -->
            <div id="chart-loading" style="display: flex; align-items: center; justify-content: center; height: 400px; background: var(--card-bg); border-radius: 8px; color: var(--text-secondary);">
              <div style="text-align: center;">
                <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid var(--border-color); border-top: 3px solid var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                <div>차트 로딩중...</div>
              </div>
            </div>
          </div>
          </div>
        </div>
        
        <!-- 뉴스 영역 -->
        <div class="news-container">
          <div class="section-header">
            <h3 class="section-title">
              <i class="fas fa-newspaper"></i>
              크립토 뉴스
            </h3>
            <div class="news-header-controls">
              <button class="refresh-news-btn" id="refresh-news" title="뉴스 새로고침">
              <i class="fas fa-sync-alt"></i>
            </button>
              <a href="news/" class="view-all-news-btn" title="모든 뉴스 보기">
                <i class="fas fa-external-link-alt"></i>
                전체보기
              </a>
            </div>
          </div>
          <div class="news-list" id="news-list">
            <div class="loading-news">
              <div class="loading-spinner"></div>
              <span>최신 뉴스 로딩 중...</span>
            </div>
          </div>
        </div>
        
        <!-- 실시간 이벤트 카드 영역 -->
        <div class="indices-container">
          <div class="section-header">
            <h3 class="section-title">
              <i class="fas fa-calendar-alt"></i>
              실시간 이벤트
            </h3>
            <div class="news-header-controls">
              <button class="refresh-indices-btn" id="refresh-events">
              <i class="fas fa-sync-alt"></i>
            </button>
              <a href="event-board.html" class="view-all-news-btn" title="모든 이벤트 보기">
                <i class="fas fa-external-link-alt"></i>
                전체보기
              </a>
          </div>
          </div>
          <div class="indices-content" id="events-content">
            <div class="loading-indices">
              <div class="loading-spinner"></div>
              <span>이벤트 데이터 로딩 중...</span>
            </div>
          </div>
        </div>
      </div>
    </section>

  <!-- 실시간 코인 시세 테이블 섹션 -->
    <section class="crypto-table-section">
      <div class="section-header">
        <h3 class="section-title">
          <i class="fas fa-coins"></i>
          실시간 코인 시세
        </h3>
        <div class="table-controls">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="coin-search" placeholder="코인 검색...">
          </div>
          <button class="refresh-btn" id="refresh-data">
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
      </div>
      
      <div class="crypto-table-wrapper">
                 <div class="table-tabs">
           <button class="tab-btn active" data-category="all">전체</button>
           <button class="tab-btn" data-category="gainers">상승</button>
           <button class="tab-btn" data-category="losers">하락</button>
         </div>
        
        <div class="crypto-table-container">
                     <table class="crypto-table" id="crypto-table">
             <thead>
               <tr>
                 <th class="sortable rank-col" data-sort="rank">순위</th>
                 <th class="sortable name-col" data-sort="name">코인</th>
                 <th class="sortable price-col" data-sort="price">가격</th>
                 <th class="sortable change-col" data-sort="change1h">가격(1H%)</th>
                 <th class="sortable change-col" data-sort="change24h">가격(24H %)</th>
                 <th class="sortable funding-col" data-sort="fundingRate">자금 조달 비율</th>
                 <th class="sortable volume-col" data-sort="volume">24H 볼륨($)</th>
                 <th class="sortable oi-col" data-sort="openInterest">OI($)</th>
                 <th class="sortable oi-change-col" data-sort="oiChange1h">OI(1H%)</th>
                 <th class="sortable oi-change-col" data-sort="oiChange4h">OI(4H%)</th>
                 <th class="sortable market-col" data-sort="marketCap">Market Cap($)</th>
                 <th class="sortable liquidation-col" data-sort="liquidation1h">1H 청산($)</th>
                 <th class="sortable liquidation-col" data-sort="liquidation24h">24H 청산($)</th>
                 <th class="chart-col">차트</th>
               </tr>
             </thead>
            <tbody id="crypto-table-body">
              <!-- 코인 데이터가 여기에 동적으로 추가됩니다 -->
            </tbody>
          </table>
        </div>
        
        <div class="table-pagination">
          <button class="page-btn" id="prev-page" disabled>이전</button>
          <span class="page-info" id="page-info">1 / 1</span>
          <button class="page-btn" id="next-page">다음</button>
        </div>
      </div>
    </section>

  <!-- 고래 거래 설정 모달 -->
  <div id="whale-settings-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>고래 거래 추적 설정</h2>
        <button class="modal-close" id="close-whale-settings">&times;</button>
      </div>
      <div class="modal-body">
        <div id="whale-settings-list">
          <!-- 설정 항목들이 여기에 동적으로 추가됩니다 -->
        </div>
      </div>
      <div class="modal-footer">
        <button id="save-whale-settings" class="btn btn-primary">설정 저장</button>
      </div>
    </div>
  </div>

  <!-- Footer placeholder -->
  <div id="footer-placeholder"></div>

  <!-- Scripts - Load in correct order -->
  <script src="js/auth.js"></script>
  <script src="js/header-loader.js"></script>
  <script src="js/footer-loader.js"></script>
  <script src="js/analysis/longshort-tracker.js" type="module"></script>
  <script src="js/analysis/whale-tracker.js" type="module"></script>
  <script src="js/compound-calculator.js" type="module"></script>
  <!-- html2canvas for modal capture -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script type="module">
    // Whale Tracker 초기화
    import { WhaleTracker } from './js/analysis/whale-tracker.js';
    
    // DOM 로드 후 초기화
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        try {
          window.whaleTracker = new WhaleTracker();
          console.log('Whale Tracker 초기화 완료');
        } catch (error) {
          console.error('Whale Tracker 초기화 실패:', error);
        }
      }, 1000);
    });
  </script>
  <script src="js/compound-calculator.js" type="module"></script>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  
  <!-- Firebase SDK for Events -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { firebaseConfig } from './firebase-config.js';
    
    // Firebase 초기화
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    
    // 전역 변수로 Firebase 객체들 노출 (바인딩 유지)
    window.firebaseDB = db;
    window.firebaseCollection = collection.bind(null, db);
    window.firebaseGetDocs = getDocs;
    window.firebaseQuery = query;
    window.firebaseOrderBy = orderBy;
    window.firebaseLimit = limit;
    
    // Firebase 초기화 완료 플래그
    window.firebaseInitialized = true;
    
    console.log('Firebase 초기화 완료');
    
    // Firebase 초기화 완료 이벤트 발생
    window.dispatchEvent(new CustomEvent('firebaseInitialized'));
  </script>

  <script>
    // 페이지 초기화
    document.addEventListener('DOMContentLoaded', function() {

      
      // 페이지별 초기화 함수 호출
      if (typeof initializePage === 'function') {
        initializePage();
      }
      
      // TradingView 차트 즉시 초기화
      if (window.TradingView) {
        // 선택된 심볼로 초기화
        const chartSymbol = document.getElementById('chart-symbol');
        const initialSymbol = chartSymbol ? chartSymbol.value : 'BTCUSDT';
        initializeTradingViewChart(initialSymbol);
      } else {
        // TradingView 라이브러리가 로드될 때까지 짧은 간격으로 체크
        let checkCount = 0;
        const checkTradingView = setInterval(() => {
          checkCount++;
          if (window.TradingView) {
            clearInterval(checkTradingView);
            // 선택된 심볼로 초기화
            const chartSymbol = document.getElementById('chart-symbol');
            const initialSymbol = chartSymbol ? chartSymbol.value : 'BTCUSDT';
            initializeTradingViewChart(initialSymbol);
          } else if (checkCount > 50) { // 5초 후 포기
            clearInterval(checkTradingView);
            console.warn('TradingView 라이브러리 로딩 타임아웃');
          }
        }, 100);
      }
    });
    
        // 전역 TradingView 위젯 인스턴스
    let tradingViewWidget = null;
    let currentChartSymbol = 'BTCUSDT';

    // 현재 시간 프레임 저장
    let currentTimeframe = '1';

    // TradingView 차트 초기화 함수 (최적화)
    function initializeTradingViewChart(symbol = 'BTCUSDT', interval = null) {
      const chartContainer = document.getElementById('tradingview_chart');
      if (!chartContainer) {
        console.warn('차트 컨테이너를 찾을 수 없습니다.');
            return;
          }

      try {
        // 로딩 표시 제거
        const loadingElement = document.getElementById('chart-loading');
        if (loadingElement) {
          loadingElement.style.display = 'none';
        }
        
        // 기존 위젯이 있다면 제거
        if (tradingViewWidget) {
          try {
            tradingViewWidget.remove();
          } catch (e) {
            console.warn('기존 위젯 제거 중 오류:', e);
          }
        }
        
        // 컨테이너 초기화
        chartContainer.innerHTML = '';
        
        const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark';
        currentChartSymbol = symbol;
        
        // 시간 프레임 설정 (interval이 제공되면 사용, 아니면 현재 설정 사용)
        const timeframe = interval || currentTimeframe;
        
        tradingViewWidget = new TradingView.widget({
          "autosize": true,
          "symbol": `BINANCE:${symbol}`,
          "interval": timeframe,
          "timezone": "Asia/Seoul",
          "theme": isDarkMode ? "dark" : "light",
          "style": "1",
          "locale": "ko",
          "toolbar_bg": isDarkMode ? "#1e222d" : "#f1f3f6",
          "enable_publishing": false,
          "hide_top_toolbar": true,
          "hide_legend": false,
          "hide_side_toolbar": false,
          "save_image": false,
          "container_id": "tradingview_chart",
          "disabled_features": [
            "use_localstorage_for_settings",
            "volume_force_overlay",
            "create_volume_indicator_by_default"
          ],
          "enabled_features": [
            "study_templates"
          ],
          "loading_screen": {
            "backgroundColor": isDarkMode ? "#1e222d" : "#ffffff",
            "foregroundColor": isDarkMode ? "#ffffff" : "#000000"
          },
          "overrides": {
            "paneProperties.background": isDarkMode ? "#1e222d" : "#ffffff",
            "paneProperties.vertGridProperties.color": isDarkMode ? "#363c4e" : "#e1e3e6",
            "paneProperties.horzGridProperties.color": isDarkMode ? "#363c4e" : "#e1e3e6"
          }
        });
        
      } catch (error) {
        console.error('TradingView 차트 초기화 실패:', error);
        // 백업 차트 표시
        chartContainer.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);">
            <div style="text-align: center;">
              <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 1rem;"></i>
              <div>차트를 불러오는 중...</div>
            </div>
          </div>
        `;
      }
    }

    // 분봉 변경 함수
    function changeTimeframe(timeframe) {
      currentTimeframe = timeframe;
      
      // 모든 분봉 버튼에서 active 클래스 제거
      document.querySelectorAll('.timeframe-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // 선택된 버튼에 active 클래스 추가
      const selectedBtn = document.querySelector(`[data-timeframe="${timeframe}"]`);
      if (selectedBtn) {
        selectedBtn.classList.add('active');
      }
      
      // 현재 심볼로 차트 재초기화
      const chartSymbol = document.getElementById('chart-symbol');
      const symbol = chartSymbol ? chartSymbol.value : 'BTCUSDT';
      
      // 로딩 표시
      const chartContainer = document.getElementById('tradingview_chart');
      if (chartContainer) {
        chartContainer.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);">
            <div style="text-align: center;">
              <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid var(--border-color); border-top: 3px solid var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
              <div>분봉 변경 중...</div>
            </div>
          </div>
        `;
      }
      
      setTimeout(() => {
        initializeTradingViewChart(symbol, timeframe);
      }, 300);
    }

    // 차트 심볼 변경 함수
    function changeChartSymbol(symbol) {
      // 로딩 표시
      const chartContainer = document.getElementById('tradingview_chart');
      if (chartContainer) {
        chartContainer.innerHTML = `
          <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary);">
            <div style="text-align: center;">
              <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid var(--border-color); border-top: 3px solid var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
              <div>차트 변경 중...</div>
            </div>
          </div>
        `;
      }
      
      // 새로운 심볼로 차트 재초기화 (현재 시간 프레임 유지)
      setTimeout(() => {
        initializeTradingViewChart(symbol, currentTimeframe);
      }, 500);
    }

    // 다크모드 초기화
    function initializeDarkMode() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      const themeToggle = document.querySelector('.theme-toggle');
      if (themeToggle) {
        themeToggle.addEventListener('click', () => {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('theme', newTheme);
        });
      }
    }

    // 다크모드 초기화
    initializeDarkMode();

    // 대시보드 관리 클래스
    class Dashboard {
      constructor() {
        this.currentSymbol = 'BTCUSDT';
        this.tvWidget = null;
        this.isChartReady = false;
        this.init();
      }
      
      init() {
        this.initNews();
        this.initIndices();
        this.bindEvents();
      }
      
      initNews() {
        this.loadNews();
        setInterval(() => {
          this.loadNews();
        }, 300000); // 5분마다 뉴스 업데이트
      }
      
      async loadNews() {
        const newsList = document.getElementById('news-list');
        const CACHE_KEY = 'indexNewsFeedsCache';
        const CACHE_DURATION_MS = 3 * 60 * 1000; // 3분 캐시
        
        // 로딩 중 표시
        if (!newsList.innerHTML.includes('loading-news')) {
          newsList.innerHTML = `
            <div class="loading-news">
              <div class="loading-spinner"></div>
              <span>최신 뉴스 로딩 중...</span>
            </div>
          `;
        }
        
        try {
          // 캐시 확인
          const cached = localStorage.getItem(CACHE_KEY);
          if (cached) {
            const cacheData = JSON.parse(cached);
            const age = Date.now() - cacheData.timestamp;
            
            if (age < CACHE_DURATION_MS && cacheData.data && cacheData.data.length > 0) {
              this.displayNews(cacheData.data);
              return;
            }
          }
          
          // 뉴스 피드 로딩
          const feeds = [
            { url: 'https://kr.cointelegraph.com/rss', source: 'cointelegraph' },
            { url: 'https://www.tokenpost.kr/rss', source: 'tokenpost' },
            { url: 'https://www.blockmedia.co.kr/feed', source: 'blockmedia' },
            { url: 'https://coinreaders.com/rss/rss_news.php', source: 'coinreaders' },
            { url: 'https://www.yna.co.kr/rss/economy.xml', source: 'yonhap' },
            { url: 'https://kr.investing.com/rss/news.rss', source: 'investing' }
          ];
          
          const feedPromises = feeds.map(feed => this.fetchAndParseFeed(feed));
          const results = await Promise.allSettled(feedPromises);
          
          let allNews = [];
          results.forEach((result, index) => {
            if (result.status === 'fulfilled' && result.value.length > 0) {
              allNews.push(...result.value);
            }
          });
          
          if (allNews.length === 0) {
            throw new Error('뉴스 피드를 가져올 수 없습니다.');
          }
          
          // 중복 제거 및 정렬
          const uniqueNews = [];
          const seenLinks = new Set();
          
          allNews.forEach(item => {
            if (!seenLinks.has(item.link)) {
              seenLinks.add(item.link);
              uniqueNews.push(item);
            }
          });
          
          uniqueNews.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
          
          // 캐시 저장
          const cacheData = {
            timestamp: Date.now(),
            data: uniqueNews.slice(0, 8) // 인덱스 페이지용 8개만
          };
          localStorage.setItem(CACHE_KEY, JSON.stringify(cacheData));
          
          this.displayNews(cacheData.data);
          
        } catch (error) {
          console.error('뉴스 로딩 실패:', error);
          this.displayFallbackNews();
        }
      }
      
      async fetchAndParseFeed({ url, source }) {
        const timeoutMs = 3000;
        
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), timeoutMs);
          
          const rss2jsonUrl = 'https://api.rss2json.com/v1/api.json?rss_url=' + encodeURIComponent(url);
          const response = await fetch(rss2jsonUrl, {
            method: 'GET',
            signal: controller.signal,
            headers: {
              'Accept': 'application/json',
              'Cache-Control': 'max-age=300'
            }
          });
          
          clearTimeout(timeoutId);
          
          if (response.ok) {
            const data = await response.json();
            if (data.status === 'ok' && data.items && data.items.length > 0) {
              return data.items.slice(0, 4).map(item => {
                let contentSnippet = '';
                if (item.description) {
                  const cleanText = item.description.replace(/<[^>]*>/g, '').replace(/&[^;]+;/g, ' ').trim();
                  contentSnippet = cleanText.substring(0, 100);
                }
                
                // 이미지 추출
                let imageUrl = '';
                if (item.enclosure && item.enclosure.link) {
                  imageUrl = item.enclosure.link;
                } else if (item.thumbnail) {
                  imageUrl = item.thumbnail;
                } else if (item.description) {
                  // HTML에서 이미지 URL 추출
                  const imgMatch = item.description.match(/<img[^>]+src="([^"]+)"/);
                  if (imgMatch) {
                    imageUrl = imgMatch[1];
                  }
                }
                
                return {
                  title: item.title || '제목 없음',
                  link: item.link || '#',
                  pubDate: item.pubDate || new Date().toISOString(),
                  content: contentSnippet,
                  image: imageUrl,
                  source: source
                };
              });
            }
          }
          
          return [];
        } catch (error) {
          console.warn(`뉴스 피드 로딩 실패 (${source}):`, error);
          return [];
        }
      }
      
      displayFallbackNews() {
          const backupNews = [
            {
              title: "비트코인 가격 분석 및 전망",
              link: "https://kr.cointelegraph.com/news/bitcoin-analysis",
            source: 'cointelegraph',
            content: "최신 비트코인 가격 동향과 전문가들의 분석을 확인하세요.",
            pubDate: new Date().toISOString()
            },
            {
              title: "이더리움 2.0 업데이트 현황",
              link: "https://kr.cointelegraph.com/news/ethereum-2-update",
            source: 'cointelegraph',
            content: "이더리움 네트워크의 최신 업데이트와 개발 현황을 알아보세요.",
            pubDate: new Date().toISOString()
            },
            {
              title: "한국 디지털자산 시장 동향",
              link: "https://www.yna.co.kr/economy",
            source: 'yonhap',
            content: "국내 암호화폐 시장의 최신 동향과 규제 현황을 확인하세요.",
            pubDate: new Date().toISOString()
            },
            {
              title: "글로벌 암호화폐 시장 분석",
              link: "https://kr.investing.com/news/cryptocurrency",
            source: 'investing',
            content: "전 세계 암호화폐 시장의 트렌드와 투자 전망을 살펴보세요.",
            pubDate: new Date().toISOString()
            }
          ];
          
          this.displayNews(backupNews);
      }
      
      displayNews(newsData) {
        const newsList = document.getElementById('news-list');
        
        if (!newsData || newsData.length === 0) {
          newsList.innerHTML = `
            <div class="loading-news">
              <i class="fas fa-exclamation-triangle"></i>
              <span>뉴스를 불러올 수 없습니다</span>
              <button onclick="dashboard.loadNews()" style="margin-top: 0.5rem; padding: 0.25rem 0.5rem; border: 1px solid var(--border-strong); border-radius: 4px; background: var(--bg-primary); color: var(--text-secondary); cursor: pointer;">
                <i class="fas fa-sync-alt"></i> 다시 시도
              </button>
            </div>
          `;
            return;
          }
        
        newsList.innerHTML = newsData.map(news => {
          const sourceName = this.getSourceName(news.source);
          const timeAgo = this.getRelativeTime(news.pubDate);
          
          return `
            <div class="news-item" onclick="window.open('${news.link}', '_blank')">
              <div class="news-item-content">
              <div class="news-title">${news.title}</div>
                ${news.content ? `<div class="news-content">${news.content}</div>` : ''}
              <div class="news-meta">
                <span class="news-source">${sourceName}</span>
                  <span class="news-time">${timeAgo}</span>
              </div>
              </div>
              ${news.image ? `<div class="news-image"><img src="${news.image}" alt="뉴스 이미지" loading="lazy" onerror="this.parentElement.style.display='none'"></div>` : ''}
            </div>
          `;
        }).join('');
      }
      
      getSourceName(source) {
        const sourceNames = {
          'cointelegraph': '코인텔레그래프',
          'tokenpost': '토큰포스트',
          'blockmedia': '블록미디어',
          'coinreaders': '코인리더스',
          'bloomingbit': '블루밍비트',
          'yonhap': '연합뉴스',
          'investing': 'Investing.com'
        };
        return sourceNames[source] || source;
      }
      
      getRelativeTime(dateString) {
        const now = new Date();
        const date = new Date(dateString);
        const diffInSeconds = Math.floor((now - date) / 1000);
        
        if (diffInSeconds < 60) {
          return '방금 전';
        } else if (diffInSeconds < 3600) {
          return `${Math.floor(diffInSeconds / 60)}분 전`;
        } else if (diffInSeconds < 86400) {
          return `${Math.floor(diffInSeconds / 3600)}시간 전`;
        } else if (diffInSeconds < 2592000) {
          return `${Math.floor(diffInSeconds / 86400)}일 전`;
        } else {
          return date.toLocaleDateString('ko-KR', { 
            month: 'short', 
            day: 'numeric' 
          });
        }
      }
      
      initIndices() {
        this.loadEvents();
        setInterval(() => {
          this.loadEvents();
        }, 30000); // 30초마다 이벤트 업데이트
      }
      
      async loadEvents() {
        const eventsContent = document.getElementById('events-content');
        
        try {
          // Firebase 초기화 확인
          if (!window.firebaseInitialized || !window.firebaseDB || !window.firebaseCollection) {
            console.log('Firebase 초기화 대기 중...');
            setTimeout(() => this.loadEvents(), 1000);
            return;
          }
          
          // Firebase에서 이벤트 데이터 가져오기
          const eventsRef = window.firebaseCollection('events');
          const q = window.firebaseQuery(eventsRef, window.firebaseOrderBy('createdAt', 'desc'), window.firebaseLimit(5));
          const snapshot = await window.firebaseGetDocs(q);
          
          if (snapshot.empty) {
            eventsContent.innerHTML = `
              <div class="loading-indices">
                <i class="fas fa-calendar-alt"></i>
                <span>등록된 이벤트가 없습니다</span>
                <div style="font-size: 0.8rem; color: var(--text-muted); margin: 0.5rem 0;">
                  새로운 이벤트를 등록해보세요
                </div>
                <div class="events-view-all">
                  <a href="event-board.html" class="events-view-all-btn">
                    <i class="fas fa-plus"></i>
                    이벤트 등록하기
                  </a>
                </div>
              </div>
            `;
            return;
          }
          
          const events = [];
          snapshot.forEach(doc => {
            const data = doc.data();
            events.push({
              id: doc.id,
              title: data.title,
              desc: data.desc,
              period: data.period,
              exchange: data.exchange,
              logo: data.logo,
              img: data.img,
              link: data.link,
              createdAt: data.createdAt
            });
          });
          
          const html = events.map(event => this.renderEventItem(event)).join('');
          eventsContent.innerHTML = html + `
            <div class="events-view-all">
              <a href="event-board.html" class="events-view-all-btn">
                <i class="fas fa-calendar-alt"></i>
                모든 이벤트 보기
              </a>
            </div>
          `;
          
          // 이벤트 카드 클릭 이벤트 추가
          document.querySelectorAll('.event-item').forEach(card => {
            card.addEventListener('click', () => {
              const link = card.dataset.link;
              if (link) {
                window.open(link, '_blank');
              }
            });
          });
          
          // 이미지 로딩 상태 관리
          document.querySelectorAll('.event-image img').forEach(img => {
            img.classList.add('loading');
            
            img.onload = () => {
              img.classList.remove('loading');
              img.classList.add('loaded');
            };
            
            img.onerror = () => {
              img.classList.remove('loading');
              img.classList.add('error');
              img.src = '/assets/default-event-image.svg';
            };
          });
          
        } catch (error) {
          console.error('이벤트 데이터 로드 실패:', error);
          
          // Firebase 관련 오류인지 확인
          const isFirebaseError = error.message && error.message.includes('collection');
          
          if (isFirebaseError) {
            eventsContent.innerHTML = `
            <div class="loading-indices">
              <i class="fas fa-exclamation-triangle"></i>
                <span>Firebase 연결 오류</span>
              <div style="font-size: 0.8rem; color: var(--text-muted); margin: 0.5rem 0;">
                  잠시 후 자동으로 재시도됩니다
              </div>
              </div>
            `;
            
            // 5초 후 재시도
            setTimeout(() => {
              if (this && typeof this.loadEvents === 'function') {
                this.loadEvents();
              }
            }, 5000);
          } else {
            eventsContent.innerHTML = `
              <div class="loading-indices">
                <i class="fas fa-exclamation-triangle"></i>
                <span>이벤트를 불러올 수 없습니다</span>
                <button onclick="dashboard.loadEvents()" style="margin-top: 0.5rem; padding: 0.25rem 0.5rem; border: 1px solid var(--border-strong); border-radius: 4px; background: var(--bg-primary); color: var(--text-secondary); cursor: pointer;">
                <i class="fas fa-sync-alt"></i> 다시 시도
              </button>
          </div>
        `;
          }
        }
      }
      
      renderEventItem(event) {
        const logoUrl = event.logo || '/assets/default-event-image.svg';
        const imageUrl = event.img || '/assets/default-event-image.svg';
        
        return `
          <div class="event-item" data-link="${event.link || ''}">
            <div class="event-content">
              <div class="event-header">
                <div class="event-info">
                  <div class="event-title">${event.title}</div>
                  <div class="event-desc">${event.desc}</div>
            </div>
                <div class="event-exchange">
                  <img class="event-exchange-logo" 
                       src="${logoUrl}" 
                       alt="${event.exchange}" 
                       loading="lazy"
                       onerror="this.src='/assets/default-event-image.svg'" />
                  <span class="event-exchange-name">${event.exchange}</span>
              </div>
            </div>
              <div class="event-meta">
                <div class="event-period">
                  <i class="fas fa-clock"></i>
                  <span>${event.period}</span>
              </div>
              </div>
            </div>
            <div class="event-image">
              <img src="${imageUrl}" 
                   alt="${event.title}" 
                   loading="lazy"
                   onerror="this.src='/assets/default-event-image.svg'" />
            </div>
          </div>
        `;
      }
      

      
      bindEvents() {
        // 차트 심볼 변경
        const chartSymbol = document.getElementById('chart-symbol');
        if (chartSymbol) {
          chartSymbol.addEventListener('change', (e) => {
            this.changeSymbol(e.target.value);
          });
        }
        
        // 뉴스 새로고침
        const refreshNews = document.getElementById('refresh-news');
        if (refreshNews) {
          refreshNews.addEventListener('click', () => {
            refreshNews.classList.add('loading');
            refreshNews.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            // 캐시 클리어
            localStorage.removeItem('indexNewsFeedsCache');
            
            this.loadNews().finally(() => {
              refreshNews.classList.remove('loading');
              refreshNews.innerHTML = '<i class="fas fa-sync-alt"></i>';
            });
          });
        }
        
        // 이벤트 새로고침
        const refreshEvents = document.getElementById('refresh-events');
        if (refreshEvents) {
          refreshEvents.addEventListener('click', () => {
            refreshEvents.classList.add('loading');
            this.loadEvents().finally(() => {
              refreshEvents.classList.remove('loading');
            });
          });
        }
      }
      
      changeSymbol(symbol) {
        this.currentSymbol = symbol;
        console.log('심볼 변경:', symbol);
        
        // 전역 차트 심볼 변경 함수 호출
        if (typeof changeChartSymbol === 'function') {
          changeChartSymbol(symbol);
        } else {
          console.warn('changeChartSymbol 함수를 찾을 수 없습니다.');
        }
      }
    }

    // 코인 테이블 기능
    class CryptoTable {
      constructor() {
        this.coins = [];
        this.filteredCoins = [];
        this.currentPage = 1;
        this.itemsPerPage = 50;
        this.sortField = 'rank';
        this.sortDirection = 'asc';
        this.currentCategory = 'all';
        this.searchTerm = '';
        
        this.init();
      }
      
      async init() {
        this.bindEvents();
        await this.loadData();
        this.render();
        
        // 5분마다 자동 업데이트 (서버 캐시와 동기화)
        setInterval(() => {
          this.loadData();
        }, 300000);
      }
      
      bindEvents() {
        // 탭 전환
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            e.target.classList.add('active');
            this.currentCategory = e.target.dataset.category;
            this.currentPage = 1;
            this.filterAndSort();
          });
        });
        
        // 검색
        const searchInput = document.getElementById('coin-search');
        if (searchInput) {
        searchInput.addEventListener('input', (e) => {
          this.searchTerm = e.target.value.toLowerCase();
          this.currentPage = 1;
          this.filterAndSort();
        });
        }
        
        // 새로고침
        const refreshBtn = document.getElementById('refresh-data');
        if (refreshBtn) {
          refreshBtn.addEventListener('click', () => {
          this.loadData();
        });
        }
        
        // 정렬
        document.querySelectorAll('.sortable').forEach(th => {
          th.addEventListener('click', () => {
            const field = th.dataset.sort;
            if (this.sortField === field) {
              this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
              this.sortField = field;
              this.sortDirection = 'asc';
            }
            this.updateSortHeaders();
            this.filterAndSort();
          });
        });
        
        // 페이지네이션
        const prevBtn = document.getElementById('prev-page');
        const nextBtn = document.getElementById('next-page');
        
        if (prevBtn) {
          prevBtn.addEventListener('click', () => {
          if (this.currentPage > 1) {
            this.currentPage--;
            this.render();
          }
        });
        }
        
        if (nextBtn) {
          nextBtn.addEventListener('click', () => {
          const totalPages = Math.ceil(this.filteredCoins.length / this.itemsPerPage);
          if (this.currentPage < totalPages) {
            this.currentPage++;
            this.render();
          }
        });
        }
      }
      
      async loadData() {
        const refreshBtn = document.getElementById('refresh-data');
        if (refreshBtn) {
        refreshBtn.classList.add('loading');
        }
        
        try {
          console.log('CoinGecko API에서 직접 데이터 로딩 중...');
          
          // 직접 CoinGecko API 호출 (로컬/프로덕션 모두)
            const promises = [];
            for (let page = 1; page <= 2; page++) {
              promises.push(
                fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=250&page=${page}&sparkline=true&price_change_percentage=1h%2C24h%2C7d`)
                  .then(res => {
                    if (!res.ok) {
                      throw new Error(`API 응답 오류: ${res.status}`);
                    }
                    return res.json();
                  })
              );
            }
            
            const results = await Promise.allSettled(promises);
          let allData = [];
          
            for (const result of results) {
              if (result.status === 'fulfilled') {
                allData.push(...result.value);
              }
            }
            
          if (allData.length === 0) {
            throw new Error('모든 API 요청이 실패했습니다');
          }
          
            // 데이터 처리
            const processedData = allData.map((coin, index) => ({
            id: coin.id,
              rank: coin.market_cap_rank || index + 1,
              name: coin.name?.replace(/['">\s]+/g, ' ').trim() || '',
              symbol: coin.symbol?.replace(/['">\s]+/g, ' ').trim().toUpperCase() || '',
            image: coin.image,
            price: coin.current_price,
            change1h: coin.price_change_percentage_1h_in_currency || 0,
            change24h: coin.price_change_percentage_24h || 0,
              change7d: coin.price_change_percentage_7d_in_currency || 0,
            volume: coin.total_volume,
              marketCap: coin.market_cap,
              sparkline: coin.sparkline_in_7d ? coin.sparkline_in_7d.price : [],
              lastUpdated: new Date().toISOString()
            }));
            
            // 시가총액 순으로 정렬
            processedData.sort((a, b) => (b.marketCap || 0) - (a.marketCap || 0));
            
            // 순위 재정렬
            processedData.forEach((coin, index) => {
              coin.rank = index + 1;
            });
            
            // 추가 데이터 계산
          const data = processedData.map(coin => ({
              ...coin,
              fundingRate: this.calculateFundingRate(coin),
            openInterest: this.calculateOpenInterest(coin),
            oiChange1h: this.calculateOIChange(coin, '1h'),
            oiChange4h: this.calculateOIChange(coin, '4h'),
            liquidation1h: this.calculateLiquidation(coin, '1h'),
              liquidation24h: this.calculateLiquidation(coin, '24h')
            }));
            
            console.log(`${data.length}개 코인 데이터 처리 완료`);
          
          // 데이터 매핑
          this.coins = data.map(coin => ({
            id: coin.id,
            rank: coin.rank,
            name: coin.name,
            symbol: coin.symbol,
            image: coin.image,
            price: coin.price,
            change1h: coin.change1h,
            change24h: coin.change24h,
            fundingRate: coin.fundingRate,
            volume: coin.volume,
            openInterest: coin.openInterest,
            oiChange1h: coin.oiChange1h,
            oiChange4h: coin.oiChange4h,
            marketCap: coin.marketCap,
            liquidation1h: coin.liquidation1h,
            liquidation24h: coin.liquidation24h,
            sparkline: coin.sparkline || []
          }));
          
          this.filterAndSort();
          
        } catch (error) {
          console.error('데이터 로딩 실패:', error);
          
          // 에러 표시
          const tbody = document.getElementById('crypto-table-body');
          if (tbody) {
            tbody.innerHTML = `
              <tr>
                <td colspan="14" class="loading-row" style="text-align: center; padding: 2rem;">
                  <div style="color: var(--text-secondary);">
                    <i class="fas fa-exclamation-triangle" style="margin-bottom: 0.5rem; font-size: 1.5rem;"></i>
                    <div>실시간 데이터를 불러올 수 없습니다</div>
                    <div style="font-size: 0.9rem; margin-top: 0.5rem;">
                      CoinGecko API 호출에 실패했습니다. 잠시 후 다시 시도해주세요.
                    </div>
                    <button onclick="cryptoTable.loadData()" style="
                      margin-top: 1rem; 
                      padding: 0.5rem 1rem; 
                      border: 1px solid var(--border-strong); 
                      border-radius: 6px; 
                      background: var(--accent-blue); 
                      color: white; 
                      cursor: pointer;
                      font-size: 0.9rem;
                    ">
                      <i class="fas fa-sync-alt"></i> 다시 시도
                    </button>
                  </div>
                </td>
              </tr>
            `;
          }
        } finally {
          if (refreshBtn) {
          refreshBtn.classList.remove('loading');
          }
        }
      }
      

      
      filterAndSort() {
        let filtered = [...this.coins];
        
               // 카테고리 필터링
         switch (this.currentCategory) {
           case 'gainers':
             filtered = filtered.filter(coin => coin.change24h > 0);
             break;
           case 'losers':
             filtered = filtered.filter(coin => coin.change24h < 0);
             break;
         }
        
        // 검색 필터링
        if (this.searchTerm) {
          filtered = filtered.filter(coin => 
            coin.name.toLowerCase().includes(this.searchTerm) ||
            coin.symbol.toLowerCase().includes(this.searchTerm)
          );
        }
        
        // 정렬
        filtered.sort((a, b) => {
          let aVal = a[this.sortField];
          let bVal = b[this.sortField];
          
          if (typeof aVal === 'string') {
            aVal = aVal.toLowerCase();
            bVal = bVal.toLowerCase();
          }
          
          if (this.sortDirection === 'asc') {
            return aVal > bVal ? 1 : -1;
          } else {
            return aVal < bVal ? 1 : -1;
          }
        });
        
        this.filteredCoins = filtered;
        this.currentPage = 1;
        this.render();
      }
      
      render() {
        const tbody = document.getElementById('crypto-table-body');
        if (!tbody) return;
        
        const startIndex = (this.currentPage - 1) * this.itemsPerPage;
        const endIndex = startIndex + this.itemsPerPage;
        const pageCoins = this.filteredCoins.slice(startIndex, endIndex);
        
        if (pageCoins.length === 0) {
                     tbody.innerHTML = `
             <tr>
               <td colspan="14" class="loading-row">
                 ${this.coins.length === 0 ? 
                   '<div class="loading-spinner"></div> 데이터 로딩 중...' : 
                   '검색 결과가 없습니다.'
                 }
               </td>
             </tr>
           `;
          return;
        }
        
                 tbody.innerHTML = pageCoins.map(coin => {
           const fallbackSvg = this.createFallbackSvg(coin.symbol);
           return `
           <tr data-coin-id="${coin.id}">
             <td>${coin.rank}</td>
             <td>
               <div class="coin-info">
                 <img src="${coin.image}" alt="${coin.name}" class="coin-logo" 
                      onerror="this.src='${fallbackSvg}'">
                 <div class="coin-details">
                   <div class="coin-name">${coin.name}</div>
                   <div class="coin-symbol">${coin.symbol}</div>
                 </div>
               </div>
             </td>
             <td class="price">$${this.formatPrice(coin.price)}</td>
             <td><span class="change ${this.getChangeClass(coin.change1h)}">${this.formatPercent(coin.change1h)}</span></td>
             <td><span class="change ${this.getChangeClass(coin.change24h)}">${this.formatPercent(coin.change24h)}</span></td>
             <td><span class="change ${this.getChangeClass(coin.fundingRate)}">${this.formatPercent(coin.fundingRate)}</span></td>
             <td class="volume">$${this.formatNumber(coin.volume)}</td>
             <td class="oi">$${this.formatNumber(coin.openInterest)}</td>
             <td><span class="change ${this.getChangeClass(coin.oiChange1h)}">${this.formatPercent(coin.oiChange1h)}</span></td>
             <td><span class="change ${this.getChangeClass(coin.oiChange4h)}">${this.formatPercent(coin.oiChange4h)}</span></td>
             <td class="market-cap">$${this.formatNumber(coin.marketCap)}</td>
             <td class="liquidation">$${this.formatNumber(coin.liquidation1h)}</td>
             <td class="liquidation">$${this.formatNumber(coin.liquidation24h)}</td>
             <td>
               <canvas class="mini-chart" width="60" height="30" 
                      onclick="window.open('https://www.tradingview.com/chart/?symbol=BINANCE:${coin.symbol}USDT', '_blank')"
                       data-sparkline='${JSON.stringify(coin.sparkline)}'></canvas>
             </td>
           </tr>
           `;
         }).join('');
        
        // 미니 차트 그리기
        this.drawMiniCharts();
        
        // 페이지네이션 업데이트
        this.updatePagination();
      }
      
      drawMiniCharts() {
        document.querySelectorAll('.mini-chart').forEach(canvas => {
          const sparkline = JSON.parse(canvas.dataset.sparkline || '[]');
          if (!sparkline || sparkline.length === 0) return;
          
          const ctx = canvas.getContext('2d');
          const width = canvas.width;
          const height = canvas.height;
          
          ctx.clearRect(0, 0, width, height);
          
          const min = Math.min(...sparkline);
          const max = Math.max(...sparkline);
          const range = max - min;
          
          if (range === 0) return;
          
          ctx.strokeStyle = sparkline[sparkline.length - 1] > sparkline[0] ? '#10b981' : '#ef4444';
          ctx.lineWidth = 1.5;
          ctx.beginPath();
          
          sparkline.forEach((price, index) => {
            const x = (index / (sparkline.length - 1)) * width;
            const y = height - ((price - min) / range) * height;
            
            if (index === 0) {
              ctx.moveTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          });
          
          ctx.stroke();
        });
      }
      
      updateSortHeaders() {
        document.querySelectorAll('.sortable').forEach(th => {
          th.classList.remove('sort-asc', 'sort-desc');
          if (th.dataset.sort === this.sortField) {
            th.classList.add(`sort-${this.sortDirection}`);
          }
        });
      }
      
      updatePagination() {
        const totalPages = Math.ceil(this.filteredCoins.length / this.itemsPerPage);
        
        const prevBtn = document.getElementById('prev-page');
        const nextBtn = document.getElementById('next-page');
        const pageInfo = document.getElementById('page-info');
        
        if (prevBtn) prevBtn.disabled = this.currentPage === 1;
        if (nextBtn) nextBtn.disabled = this.currentPage === totalPages || totalPages === 0;
        if (pageInfo) {
          const startItem = (this.currentPage - 1) * this.itemsPerPage + 1;
          const endItem = Math.min(this.currentPage * this.itemsPerPage, this.filteredCoins.length);
          pageInfo.textContent = `${startItem}-${endItem} / ${this.filteredCoins.length} (페이지 ${this.currentPage}/${totalPages || 1})`;
        }
      }
      
      formatPrice(price) {
        if (price >= 1) {
          return price.toLocaleString('en-US', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
          });
        } else {
          return price.toFixed(6);
        }
      }
      
      formatPercent(percent) {
        const sign = percent >= 0 ? '+' : '';
        return `${sign}${percent.toFixed(2)}%`;
      }
      
      formatNumber(num) {
        if (num >= 1e12) {
          return (num / 1e12).toFixed(2) + 'T';
        } else if (num >= 1e9) {
          return (num / 1e9).toFixed(2) + 'B';
        } else if (num >= 1e6) {
          return (num / 1e6).toFixed(2) + 'M';
        } else if (num >= 1e3) {
          return (num / 1e3).toFixed(2) + 'K';
        } else {
          return num.toLocaleString();
        }
      }
      
      getChangeClass(change) {
        if (change > 0) return 'positive';
        if (change < 0) return 'negative';
        return 'neutral';
      }
      
      // 텍스트 정리 함수 (B'"> 오류 해결)
      cleanText(text) {
        if (!text) return '';
        return text
          .replace(/[A-Z]'">/g, '') // B'"> 같은 패턴 제거
          .replace(/['">\s]+/g, ' ') // 따옴표, 꺽쇠, 공백 정리
          .trim();
      }
      
      // 백업 SVG 생성
      createFallbackSvg(symbol) {
        const firstChar = symbol ? symbol.charAt(0) : '?';
        const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
          <circle cx="16" cy="16" r="16" fill="#ddd"/>
          <text x="16" y="20" text-anchor="middle" fill="#999" font-size="10">${firstChar}</text>
        </svg>`;
        return 'data:image/svg+xml,' + encodeURIComponent(svg);
      }
      
      // 추가 데이터 계산 함수들
      calculateFundingRate(coin) {
        const volatility = Math.abs(coin.change24h || 0);
        const volumeRatio = Math.min((coin.volume || 0) / (coin.marketCap || 1), 1);
        
        let funding = (Math.sin(coin.rank || 1) * 0.05) + (volatility * 0.01);
        funding *= (1 + volumeRatio * 0.5);
        
        return Math.max(-0.1, Math.min(0.1, funding));
      }
      
      calculateOpenInterest(coin) {
        const baseRatio = 0.08;
        const volumeBoost = Math.min((coin.volume || 0) / (coin.marketCap || 1), 0.5) * 0.1;
        const rankBoost = Math.max(0, (100 - (coin.rank || 100)) / 1000);
        
        return (coin.marketCap || 0) * (baseRatio + volumeBoost + rankBoost);
      }

      calculateOIChange(coin, period) {
        const priceChange = period === '1h' ? 
          (coin.change1h || 0) : 
          (coin.change24h || 0) / 4;
        
        const correlation = -0.3 + (Math.random() * 0.6);
        return priceChange * correlation;
      }
      
      calculateLiquidation(coin, period) {
        const volatility = Math.abs(coin.change24h || 0);
        const volume = coin.volume || 0;
        
        const liquidationRatio = Math.min(volatility * 0.02, 0.1);
        const baseLiquidation = volume * liquidationRatio;
        
        return period === '24h' ? baseLiquidation : baseLiquidation / 24;
      }
      

      
      // TradingView 열기
      openTradingView(symbol) {
        const url = `https://www.tradingview.com/chart/?symbol=BINANCE:${symbol}`;
        window.open(url, '_blank');
      }
    }

    // 페이지 로드 후 초기화
    let dashboard;
    let cryptoTable;
    
    // 대시보드 초기화 함수
    function initializeDashboard() {
      // 분봉 버튼 이벤트 리스너 추가
      document.querySelectorAll('.timeframe-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const timeframe = this.getAttribute('data-timeframe');
          changeTimeframe(timeframe);
        });
      });
      
      // 차트 심볼 변경 이벤트 리스너
      const chartSymbol = document.getElementById('chart-symbol');
      if (chartSymbol) {
        chartSymbol.addEventListener('change', function() {
          const symbol = this.value;
          changeChartSymbol(symbol);
        });
      }
      
      // 대시보드 초기화
      try {
        dashboard = new Dashboard();
      } catch (error) {
        console.error('Dashboard 초기화 실패:', error);
      }
      
      // 코인 테이블 초기화
      setTimeout(() => {
        try {
          cryptoTable = new CryptoTable();
        } catch (error) {
          console.error('CryptoTable 초기화 실패:', error);
        }
      }, 1000);
    }
    
    // Firebase 초기화 완료 후 대시보드 초기화
    document.addEventListener('DOMContentLoaded', function() {
      // Firebase가 이미 초기화되었는지 확인
      if (window.firebaseInitialized && window.firebaseDB) {
        initializeDashboard();
      } else {
        // Firebase 초기화를 기다림
        const checkFirebase = setInterval(() => {
          if (window.firebaseInitialized && window.firebaseDB) {
            clearInterval(checkFirebase);
            initializeDashboard();
          }
        }, 100);
        
        // Firebase 초기화 완료 이벤트 리스너
        window.addEventListener('firebaseInitialized', function() {
          clearInterval(checkFirebase);
          initializeDashboard();
        });
        
        // 10초 후 타임아웃
        setTimeout(() => {
          clearInterval(checkFirebase);
          console.warn('Firebase 초기화 타임아웃');
          initializeDashboard(); // Firebase 없이도 다른 기능들은 초기화
        }, 10000);
      }
    });
    
    // 복리 계산기 초기화
    document.addEventListener('DOMContentLoaded', function() {
      // 복리 계산기 초기화
      if (typeof window.CompoundCalculator !== 'undefined') {
        window.compoundCalculator = new window.CompoundCalculator();
        console.log('💰 복리 계산기 초기화 완료');
      } else {
        console.warn('복리 계산기 클래스를 찾을 수 없습니다');
      }
    });
  </script>
</body>
</html>